var suggestions=document.getElementById("suggestions"),search=document.getElementById("search");search!==null&&document.addEventListener("keydown",inputFocus);function inputFocus(e){e.ctrlKey&&e.key==="/"&&(e.preventDefault(),search.focus()),e.key==="Escape"&&(search.blur(),suggestions.classList.add("d-none"))}document.addEventListener("click",function(e){var t=suggestions.contains(e.target);t||suggestions.classList.add("d-none")}),document.addEventListener("keydown",suggestionFocus);function suggestionFocus(e){const s=suggestions.classList.contains("d-none");if(s)return;const t=[...suggestions.querySelectorAll("a")];if(t.length===0)return;const n=t.indexOf(document.activeElement);if(e.key==="ArrowUp"){e.preventDefault();const s=n>0?n-1:0;t[s].focus()}else if(e.key==="ArrowDown"){e.preventDefault();const s=n+1<t.length?n+1:n;t[s].focus()}}(function(){var e=new FlexSearch.Document({tokenize:"forward",cache:100,document:{id:"id",store:["href","title","description"],index:["title","description","content"]}});e.add({id:0,href:"/blog/miscellaneous/",title:"Miscellaneous",description:"Uncategorized notes.",content:`Table of contents
Connector Power factor Interfacing Matlab Simulink with Plexim PLECS Potentiometers Connector # Blade connectors (lower half of photo). Ring and spade terminals (upper half). Bullet terminals, male and female (right-center, with blue wires)
Blade connector Split-ring or lugs terminals for 2.5 mmÂ² wire. Banana jack connector Using crimping tool to join wire to the connector.
Crimping tool Power factor # Apparent power, reactive power and real power The picture shows the relationship between \u0026ldquo;Apparent Power\u0026rdquo;, \u0026ldquo;Reactive Power\u0026rdquo; and \u0026ldquo;Real Power\u0026rdquo;.
Reactive power is an AC power flow through the operation of the inductors and capacitors. This kind of power doesn\u0026rsquo;t contribute to the See more at What is the role of reactive power in transmission networks?
Interfacing Matlab Simulink with Plexim PLECS # Potentiometers # P16NP504KAB15 Vishay / Sfernice | Mouser Denmark
There\u0026rsquo;s a LOT of files on the official LTwiki.
For potentiometers look in (source):
http://ltwiki.org/files/LTspiceIV/lib/sym/Pot\u0026amp;Sw/ for the symbols, and http://ltwiki.org/files/LTspiceIV/lib/sub/Pote.lib is the associated library, (including both potentiometer_standard.lib and potentiometer_tapped.lib with documentation and sample files at http://ltwiki.org/files/LTspiceIV/examples/LtSpicePlus/Discretos/Sw\u0026amp;Pote/ `}),e.add({id:1,href:"/blog/materials-reliability-and-failure-analysis/",title:"Materials, Reliability and Failure Analysis",description:"Meterial science and testing",content:"Kinetic thermal energy $$ K_{kin} = \\frac{m}{2}v_{th}^2 = \\frac{3}{2}kT $$\nWhen an electric field $E$ is applied, each carrier (i.e. electrons and holes) experiences a force $Â± q \\times E$ and is accelerated. These velocities caused by the external electrical field $E$ are called drift velocities 1.\nThe current density $J$, or the current flow of electrons per unit volume, is given by the following:\n$$ \\begin{align*} J_n \u0026amp;= nqv_d \\newline J_n \u0026amp;= nq\\dfrac{1}{2} \\dfrac{q\\tau}{m^{2}}E \\end{align*} $$\nElectron mobility $\\mu_n$ is the ratio of drift velocity to the electric field strength.\n$$ \\mu_n = \\dfrac{\\nu_d}{E} = \\dfrac{q \\tau}{m^*} $$\nHight voltage Shottky diode # Anisotropic: Sic, GaN. Mobility are different in parallel $\\mu_{\\parallel}$ and perpendicular $\\mu_{\\perp}$ direction. Phonons: lattice vibration Scattering: small amount of things spread over an area. More dopping \u0026ndash;\u0026gt; more phonons \u0026ndash;\u0026gt; $\\mu_{n} \\downarrow$ and desisty $\\downarrow$. However, in combination with thickness and doping density \u0026ndash;\u0026gt; Wide Bandgap semiconductors have lower conduction losses. Shottky diode: $E_{max}$ at the contact semiconductor and metal or P-N junction. Merged PiN Schottky Diodes (MPS) structure: reduce electrical field stress \u0026ldquo;Trench Oxide Pin Schottky\u0026rdquo; (TOPS): reduce contact between metal and semiconductor \u0026ndash;\u0026gt; prevent the migration of carriers at the anode (metal). The rest of structure is the same as MPS 2. Soft recovery. Soft factor $s = \\cfrac{t_f}{t_s} \\gt 0.8$ Cross section of a merged pin Schottky diode in SiC 3 References # 4: Carrier Drift and Mobility\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nLutz, J., Schlangenotto, H., Scheuermann, U. and De Doncker, R., 2011. Semiconductor power devices. Physics, characteristics, reliability, 2.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nSiC Semiconductor Devices Technology, Modeling, and Simulation\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"}),e.add({id:2,href:"/blog/orcad-simulation-and-pcb-production/",title:"OrCAD simulation and PCB production",description:"OrCAD suite and PCB fabrication",content:`Orcard error list # ORCAP-1605 Two references have same name in different schematic. Footprint # C:\\Cadence\\SPB_17.4\\share\\pcb\\pcb_lib\\symbols
Within this folder, you can double-click on the .dra files to see footprints and the .pad files to see padstacks in PCB Editor.
SnapEDA, UltraLibrarian or Samacsys or use Place - Search Providers from within OrCAD Capture
References # OrCAD/Allegro V17.2-2016 footprints parallel-systems.co.uk Backup file orcad.co.uk Finding existing PCB footprints for Cadence PCB Editor `}),e.add({id:3,href:"/blog/classical-control-theory/",title:"Classical Control Theory",description:"Classical Control Theory series by Brian Douglas",content:"Table of contents # Table of contents 1. Background 1.1. Step function 1.2. Impulse unit function (in descrete domain) 1.3. \u0026ldquo;Linear and Time Invariance\u0026rdquo; (LTI) systems 1.4. Laplace transformation 2. Transfer function 3. Fourier transformation 4. References 1. Background # 1.1. Step function # $$ \\begin{align*} u(t)={ \\begin{cases} 1\u0026{\\text{if }}t \\ge 0 \\newline 0\u0026{\\text{if }}t \\lt 0 \\newline \\end{cases}} \\qquad u[n]={ \\begin{cases} 1\u0026{\\text{if }}n \\ge 0 \\newline 0\u0026{\\text{if }}n \\lt 0 \\newline \\end{cases}} \\end{align*} $$ 1.2. Impulse unit function (in descrete domain) # $$ \\begin{align*} \u0026 \\delta[n]={ \\begin{cases} 1\u0026{\\text{if }}n = 0 \\newline 0\u0026{\\text{if }}n \\ne 0 \\newline \\end{cases}} \\newline \u0026 u[n] = \\sum_{k = 0}^{\\infty} \\delta[n-k] \\qquad \\text{for step function} \\newline \u0026 x[n] = \\sum_{k = - \\infty}^{\\infty} x[k] \\delta[n-k] \\qquad \\text{for arbitrary function} \\end{align*} $$ We will use this relation later on.\n1.3. \u0026ldquo;Linear and Time Invariance\u0026rdquo; (LTI) systems # An example of LTI system.\n1.4. Laplace transformation # 2. Transfer function # Q. What is impulse response $h[n]$ of a system?\nA. When the input is a impulse unit function $\\delta [n]$ (see \u0026ldquo;Impulse unit function\u0026rdquo; section above)\n$$ \\begin{align*} \u0026 \\delta [n]\\overset L \\longrightarrow h[n] \\qquad \\text{ OR } \\qquad y[n] = T\\{x[n]\\} \\newline \u0026 x[n] = \\sum_{k = - \\infty}^{\\infty} x[k] \\delta[n-k] \\newline \u0026 \\Rightarrow y[n]=T \\{ \\sum_{k = - \\infty}^{\\infty} x[k] \\delta[n-k] \\} \\overset {LTI} \\longrightarrow \\sum_{k = - \\infty}^{\\infty} x[k] L \\{\\delta[n-k] \\} \\newline \u0026 \\Rightarrow y[n] = \\sum_{k = - \\infty}^{\\infty} x[k] h[n-k] := x[n]*h[n] \\quad \\text{(This is convolution)} \\end{align*} $$ Now, if we take a Laplace transformation of $y[n]$, we have.\n$$ \\begin{align*} \u0026 x [n]\\overset L \\longrightarrow X[s] \\newline \u0026 h [n]\\overset L \\longrightarrow H[s] \\qquad \\text{(where h[n] is the impulse response of the system)} \\newline \u0026 y [n] = x[n]*h[n] \\overset L \\longrightarrow Y[s] = X[s] . H[s] \\end{align*} $$ We call $H[s]$ is the transfer function of the system.\nAn example of using impulse response in the system.\nFrom convolution to transfer function.\nLet take a step back to understand this picture. In this case, $u(t)$ is input, and $x(t)$ is output. If we take $u(t)=\\delta (t)$, we should have $x(t)=X(t)$ at the output. Taking Laplace transformation both side of the equation, $X(s)$ becomes Transfer function of the system.\n3. Fourier transformation # Q. Why sinusoidal?\nA. Because its shape is the same in the LTI system. We only need to care about amplitude $A$ (i.e. Gain) and phase $\\Phi$.\nNo phase information included.\nUsing complex number to include phase information into account.\n$$ \\begin{align*} \u0026 F(v) = \\cfrac{\\sqrt{2}}{2} + \\cfrac{\\sqrt{2}}{2} j = e^{j \\pi/4} \\newline \u0026 F(v)e^{2 \\pi j v t} = e^{j \\pi/4} e^{2 \\pi j v t} \\end{align*} $$ 4. References # Brian Douglas Youtube channel, \u0026ldquo;Classical Control Theory\u0026rdquo; series Dang Quang Hieu, Digital Signal Processing lecture note "}),e.add({id:4,href:"/blog/magnetic-core/",title:"Magnetic core",description:"Magnetic core for power electronics application.",content:" Ferrite Power Materials Summary F P R J W+ Âµi (20 gauss) 25ËšC 3,000 2,500 2,300 5,000 10,000 Âµp (2000 gauss) 100ËšC 4,600 6,500 6,500 5,500 12,000 Saturation Flux Density ($B_{max}$ Gauss) 25ËšC 4,900 5,000 5,000 4,300 4,300 100ËšC 3,700 3,900 3,700 2,500 2,500 Core Loss (mw/cm3)\n(Typical)\n@100 kHz, 1000 Gauss 25ËšC 100 125 140 low-level power transf. 60ËšC 180 80* 100 100ËšC 225 125 70 Core Geometries\nCore Geometries Core Geometries Classical E ETD EFD EP Pot core RM core PQ core PM core Core selection # $$ A_p = A_E A_W = \\frac{P_{out}}{K_c K_t B_{max} F_{SW} J} 10^4 $$ $A_P$: product of window area and core area, $cm^2$ $A_E$: effective cross section of the core, $cm^2$ $A_W$: window area (or winding area), $cm^2$ At: surface area of the transformer $$ \\begin{align*} \u0026 A_e = 20 \\times 27.4 = 540 \\; mm^2 \\\\ \u0026 A_W \\text{ (often referred in datasheets as )} A_N = 4.35 \\; cm^2\\\\ \u0026 A_P = A_E Ã— A_W = 5.4 \\times 3.24 = 5.4 Ã— 4.35 = 23.5 \\; cm^4 \\end{align*} $$ References\nhttps://en.wikipedia.org/wiki/Magnetic_core https://e-magnetica.pl/list_of_ferrite_core_types Transistor, SMPS Transformer Area of Product, URL (version: 2020-06-11): https://electronics.stackexchange.com/q/504104 "}),e.add({id:5,href:"/blog/ac/dc-to-dc-converter/",title:"AC/DC to DC converter",description:"Basic AC to DC converter topologies.",content:"Table of contents\n1. Forward converter 1.1. One-switch sigle-ended forward converter (isolated buck converter) 1.2. Two-switch sigle-ended forward converter (isolated buck converter) 2. Flyback converter 2.1. RCD Clamp 3. Peak current control mode (Current-Programmed Control) 4. Slope compensation 5. Practical consideration 5.1. How to use Impedance Analyzer 6. References If you don\u0026rsquo;t know what is K1 L1 L2 1 transformer directive means, you should check 1 for more details.\n1. Forward converter # 1.1. One-switch sigle-ended forward converter (isolated buck converter) # This is essentially a buck converter with transformer inserted.\nWe want to operate in Continuous Conduction Mode. $I_{Lout}$ never reach zero.\nIn DCM we may have peak detect phenomina, we $V_{out}^{\u0026rsquo;} = (3-4) \\times V_{out}$\n$$ \\begin{align*} \u0026 \\text{- switch on: } V_{D2} = \\frac{N2}{N1} V_{in} \\\\ \u0026 \\text{- switch off: } V_{D2} = 0; \\\\ \u0026 \\frac{V_{OUT}}{V_{IN}} = \\frac{N2}{N1} D \\end{align*} $$ $$ \\text{Output voltage ripple } V_{ripple} = ESR * \\Delta I $$ ESR is from $C_{OUT}$, and $\\Delta I$ is effected by the design of $L_{out}$. Rule of thumb is $\\Delta I$ = 10% to 40% of full load.\nRefer 2 for more details.\n1.2. Two-switch sigle-ended forward converter (isolated buck converter) # also called asymmetrical half bridge forward\n2. Flyback converter # Transfer function 3 is\n$$ \\begin{align*} \\frac{V_{out}}{V_{in}} = n \\times \\frac{D}{1 - D} \\end{align*} $$ where $n$ is turn ration, and $D$ is duty cycle.\n2.1. RCD Clamp # See more at RCD Clamp 3. Peak current control mode (Current-Programmed Control) # UCC28C42 from TI using this control method.\nRefer to chapter 18 of 4, and 5.\n4. Slope compensation # Refer to 6 for more information.\nD\u0026lt;50% turburlance is faded out If Duty cycle $D\u0026gt;50%$, $I_L$ with turburlance is not stable.\nUsing new $I_{Lref}$ to solve the problem.\nHow to generate the new $I_{Lref}$?\n5. Practical consideration # 5.1. How to use Impedance Analyzer # The table is adapted from 7.\nEqui. circuit Type of DUTs A (1) Coils with high core loss; (2) To measure magnetizing inductance $L_M$, you need to open the secondary side. Only $L_M,C_1,R_{core}$ were left. B (1) coils in general; (2) resistors; (3) Measuring leakage inductance $L_{leakage}$, you need to short the secondary side. C High value resistors D Capacitors E Resonators (crystal, ceramic, ferrite) Pending\nhttps://archive.nptel.ac.in/course.html NOC:Fundamental of Power Electronics (Video) Week 12 Intro for close loop control Close looping dc-dc converters Simulation of close loop control Current control for battery charger application Instability in current control and slope compensation Slope compensated current control Simulation of current control Single phase inverter with sinusoidal pwm Simulation of sinusoidal PWM NOC:Control and Tuning Methods in Switched Mode Power Converters Week 02 Lecture 12 : Interactive MATLAB Simulation and Case Studies 6. References # LTspice: Simple Steps for Simulating Transformers\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nDavid Perreault. 6.334 Power Electronics Ch. 7. Spring 2007. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu. License: Creative Commons BY-NC-SA.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nAC Modeling of Power Stage in Flyback Converter - Texas Instruments Online\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nErickson, R. W. \u0026amp; Maksimovic, D. 2007. Fundamentals of power electronics, Springer Science \u0026amp; Business Media.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nCurrent-Mode Control, Dr. Dragan Maksimovic - University of Colorado Boulder Online\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nSlope compensation for current control - NPTEL Online\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nOperation manual Model 4191A network/spectrum Analyzer page 141/356 Online\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"}),e.add({id:6,href:"/blog/serial-protocol-through-usb-on-raspberry-pi/",title:"Serial protocol through USB on Raspberry Pi",description:"Quick way to enable serial protocol through USB connection.",content:`Table of content
1. Download Raspberry Pi OS 2. Raspberry Pi settings 3. References 1. Download Raspberry Pi OS # I am using the lite version at 2022-01-28-raspios-bullseye-armhf-lite image
cat /boot/config.txt [all] # Enable UART via PIN IO enable_uart=1 dtoverlay=dwc2 2. Raspberry Pi settings # You need to change /boot/cmdline.txt file as follows.
\$ cat /boot/cmdline.txt console=serial0,115200 console=tty1 root=PARTUUID=22e47bc0-02 rootfstype=ext4 fsck.repair=yes rootwait modules-load=dwc2,g_serial Default username/password: pi/raspberrypi. Entering sudo mode sudo su
systemctl enable getty@ttyGS0.service systemctl start getty@ttyGS0.service systemctl is-active getty@ttyGS0.service Reboot your Raspberry Pi to apply these settings.
reboot If everything is good, we\u0026rsquo;ll see a new USB Serial Device under Ports (COM \u0026amp; LPT) as following picture.
Teraterm login via USB.
3. References # Configuring the Pi Zero USB port as a serial device - mike632t Serial Gadget - adafruit `}),e.add({id:7,href:"/blog/control-of-grid-connected-inverter/",title:"Control of grid connected inverter",description:"Fundamental of grid connected inverter.",content:"Table of contents\n1. Fundamental terminologies 1.1. Power 1.2. What is postitive, negative and zero sequence? 1.3. Differential and Common Mode Signals 1.4. References 2. Filter design 2.1. L filter 2.2. References 3. Phase-locked loop References 1. Fundamental terminologies # 1.1. Power # The instantaneous electrical power P delivered to a component is given by\n$$ P(t)=I(t)\\cdot V(t) $$ where\n$P(t)$ is the instantaneous power, measured in watts (joules per second) $V(t)$ is the potential difference (or voltage drop) across the component, measured in volts $I(t)$ is the current through it, measured in amperes The average power is\n$$ P_{\\mathrm {avg}} = {\\frac {1}{T}}\\int_{0}^{T}p(t)\\mathrm {d} t $$ 1.2. What is postitive, negative and zero sequence? # These components are so-called symmetrical components 1.\nâš ï¸ Note:âš ï¸ The author was used $\\underline{z}$ to denote a vector. However, I am using $\\vec{z}$ to do this because of my personal preference.\nSymmetrical components allow unbalanced phase quantities such as currents and voltages to be replaced by three separate balanced symmetrical components\nThe transformation is defined as:\n$$ \\begin{bmatrix} \\vec{V}_+ \\\\ \\vec{V}_- \\\\ \\vec{V}_0 \\\\ \\end{bmatrix} = \\frac{1}{3} \\begin{bmatrix} 1 \u0026 \\vec{a} \u0026 \\vec{a}^2 \\\\ 1 \u0026 \\vec{a}^2 \u0026 \\vec{a} \\\\ 1 \u0026 1 \u0026 1 \\\\ \\end{bmatrix} \\begin{bmatrix} \\vec{V}_a \\\\ \\vec{V}_b \\\\ \\vec{V}_c \\\\ \\end{bmatrix} \\qquad \\text{ where } \\vec{a} = e^{j 2 \\pi /3} $$ The invert transformation is:\n$$ \\begin{bmatrix} \\vec{V}_a \\\\ \\vec{V}_b \\\\ \\vec{V}_c \\\\ \\end{bmatrix} = \\begin{bmatrix} 1 \u0026 1 \u0026 1 \\\\ \\vec{a}^2 \u0026 \\vec{a} \u0026 1 \\\\ \\vec{a} \u0026 \\vec{a}^2 \u0026 1 \\\\ \\end{bmatrix} \\begin{bmatrix} \\vec{V}_+ \\\\ \\vec{V}_- \\\\ \\vec{V}_0 \\\\ \\end{bmatrix} $$ Let take an example. Obtain the symmetrical components of a set of unbalanced voltage.\n$$ \\vec{V_a} = 5 \\angle 53 ^{\\circ} \\qquad \\vec{V_b} = 7 \\angle -164 ^{\\circ} \\qquad \\vec{V_c} = 7 \\angle 105 ^{\\circ} $$ Run this Matlab script to get the result.\nclassdef lib methods (Static = true) function [v_out_theta, v_out_rho] = sym_components_theory (va, vb, vc, isRadian) %% Symmetrical Components Theory % va: Unbalanced phase A voltage % vb: Unbalanced phase B voltage % vc: Unbalanced phase C voltage % % v_out_theta_d: Output theta in degree/radian (polar form) % v_out_rho: Output radius (polar form) % â”Œâ”€ â”€â” â”Œâ”€ â”€â” â”Œâ”€ â”€â” % â”‚V_posâ”‚ = 1/3 â”‚1 Î± Î±^2â”‚ â”‚V_aâ”‚ % â”‚V_negâ”‚ â”‚1 Î±^2 Î± â”‚ â”‚V_bâ”‚ % â”‚V_0 â”‚ â”‚1 1 1 â”‚ â”‚V_câ”‚ % â””â”€ â”€â”˜ â””â”€ â”€â”˜ â””â”€ â”€â”˜ arguments va vb vc isRadian uint8 = 0 end rho = 1; theta = 2 * pi /3; alpha = rho * exp (1i * theta); a_tran = 1 /3 * [1 alpha alpha^2; 1 alpha^2 alpha; 1 1 1]; v = [va; vb; vc]; v_out = a_tran * v; [v_out_theta, v_out_rho] = cart2pol(real(v_out), imag(v_out)); if (isRadian == 0) v_out_theta = 180* v_out_theta / pi; end end end end %% symmetrical components clc; clear; % Input va = 5 * exp(1i*53/180*pi); vb = 7 * exp(1i* (-164)/180*pi); vc = 7 * exp (1i* 105/180 * pi); % result is in Degree unit fprintf(\u0026quot;Output in V+ V- Vzero order. \\n\u0026quot;); [v_out_theta_d, v_out_rho] = lib.sym_components_theory (va, vb, vc); fprintf(\u0026quot;Radius: \\n\u0026quot;); disp(v_out_rho); fprintf(\u0026quot;Phase [Degree]: \\n\u0026quot;); disp(v_out_theta_d); % Draw complex number v_sym = v_out_rho .* exp (1i * v_out_theta_d/180 * pi); v_zero = v_sym(1); v_pos = v_sym (2); v_neg = v_sym (3); t = tiledlayout(2,2); t.Padding = 'compact'; t.TileSpacing = 'compact'; % unbalanced voltage z = [va, vb, vc]; nxt = nexttile; c = compass(nxt, real(z), imag(z)); title(nxt,'Unbalanced voltage') text(real(va) + 0.5, imag(va) + 0.5, 'Va', Color='b') c_b = c(2); c_b.Color = 'g'; % V_b is green text(real(vb) - 1.5, imag(vb) + 0.5, 'Vb', Color='g') c_c = c(3); c_c.Color = 'r'; % V_c is red text(real(vc) + 0.5, imag(vc) + 0.5, 'Vc', Color='r') % positive voltage sequence z_pos = [v_pos; v_pos * exp(1i * (-2) * pi / 3); v_pos * exp(1i * (-4) * pi / 3)]; nxt = nexttile; c_pos = compass(nxt, real(z_pos), imag(z_pos)); title(nxt,'Positive voltage sequences') c_pos_b = c_pos(2); c_pos_b.Color = 'g'; % V_b is green c_pos_c = c_pos(3); c_pos_c.Color = 'r'; % V_c is red %negative voltage sequency z_neg = [v_neg; v_neg * exp(1i * (-4) * pi / 3); v_neg * exp(1i * (-2) * pi / 3)]; nxt = nexttile; c_neg = compass(nxt, real(z_neg), imag(z_neg)); title(nxt,'Negative voltage sequences') c_neg_b = c_neg(2); c_neg_b.Color = 'g'; % V_b is green c_neg_c = c_neg(3); c_neg_c.Color = 'r'; % V_c is red % Zero sequences nxt = nexttile; c_zero = compass(nxt, real(v_zero), imag(v_zero)); title(nxt,'Zero voltage sequences') %---------------------------------------------------- %% Unbalanced current ia = 10; ib = 10 * exp(1i* (-2)/3*pi); ic = 0; [i_out_theta_d, i_out_rho] = lib.sym_components_theory (ia, ib, ic, 0) We get $V_+, V_-, V_0$ magnitude and phase accordingly.\nOutput in V+ V- Vzero order. Radius: 5.0156 1.9469 3.4718 Phase [Degree]: -10.2643 92.4259 122.0788 or, it could be written in the time domain form.\n$$ \\begin{align*} \u0026 v_a = 5.02 sin (\\omega t - 10) \u0026 \u0026+ 1.95 sin (\\omega t + 92) \u0026 \u0026+ 3.5 sin (\\omega t + 122) \\\\ \u0026 v_b = 5.02 sin (\\omega t - 10 - 120) \u0026 \u0026+ 1.95 sin (\\omega t + 92 - 240) \u0026 \u0026+ 3.5 sin (\\omega t + 122) \\\\ \u0026 v_c = \\underbrace{5.02 sin (\\omega t - 10 - 240)}_{\\text{positive seq.}} \u0026 \u0026+ \\underbrace{ 1.95 sin (\\omega t + 92 - 120)}_{\\text{negative seq.}} \u0026 \u0026+ \\underbrace{3.5 sin (\\omega t + 122)}_{\\text{Zero seq.}} \\\\ \\end{align*} $$ 1.3. Differential and Common Mode Signals # An other example.\n1.4. References # Calculate Powers in Non-sinusoidal Conditions According to IEEE 1459 Differential and Common Mode Signals 2. Filter design # 2.1. L filter # 2.2. References # AC filters for grid connected inverters in Power electronic design. Three-phase grid converter control: video 1 Grid tied inverters 3. Phase-locked loop # References # https://dsp.stackexchange.com/q/75492 Three-phase grid converter control: video 3 Phase lock loops James Kirtley Jr.. 6.061 Introduction to Electric Power Systems. Spring 2011. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu License: Creative Commons BY-NC-SA.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"}),e.add({id:8,href:"/blog/complex-number-and-its-application-in-ac-analysist/",title:"Complex number and its application in AC analysist",description:"How to use complex number to simplify the AC circuit analysist.",content:"Table of contents\n1. Sinusoidal time functions and complex number 1.1. Complex number recap 1.2. Sinusoidal Time Functions 1.3. Summary 2. Impedance Example References 1. Sinusoidal time functions and complex number # 1.1. Complex number recap # Magnitude and phase angle of the complex number $\\vec{z}$ is 1\nâš ï¸ Note:âš ï¸ The author was used $\\underline{z}$ to denote a vector. However, I am using $\\vec{z}$ to do this because of my personal preference.\n$$ |\\vec{z}|=\\sqrt{x^{2}+y^{2}} \\qquad \\phi=\\arctan \\left(\\frac{y}{x}\\right) $$ Euler relation\n$$ e^{j \\phi}=\\cos (\\phi)+j \\sin (\\phi) \\qquad \\vec{z}=x+j y=|\\vec{z}| e^{j \\phi} $$ The product and the ratio of two complex numbers are\n$$ \\vec{z}_{1}=\\left|\\vec{z}_{1}\\right| e^{j \\phi_{1}} \\qquad \\vec{z}_{2}=\\left|\\vec{z}_{2}\\right| e^{j \\phi_{2}} \\qquad \\vec{z}_{1} \\vec{z}_{2}=\\left|\\vec{z}_{1}\\right|\\left|\\vec{z}_{2}\\right| e^{j\\left(\\phi_{1}+\\phi_{2}\\right)} \\qquad \\frac{\\vec{z}_{1}}{\\vec{z}_{2}}=\\frac{\\left|\\vec{z}_{1}\\right|}{\\left|\\vec{z}_{2}\\right|} e^{j\\left(\\phi_{1}-\\phi_{2}\\right)} $$ The complex conjugate of a complex number is given by\n$$ % \\vec{z}=x+j y \\quad \\vec{z}^{*}=x-j y \\qquad \\vec{z}+\\vec{z}^{*}=2 \\operatorname{Re}(\\vec{z})=2 x \\qquad \\vec{z}-\\vec{z}^{*}=2 j \\operatorname{Im}(\\vec{z})=2 j y $$ 1.2. Sinusoidal Time Functions # A sinusoidal function of time might be written in three ways\n$$ f(t)=A \\cos (\\omega t+\\phi) \\qquad (1) \\\\ f(t)=B \\cos (\\omega t)+C \\sin (\\omega t) \\qquad (2) \\\\ f(t)=\\vec{X} e^{j \\omega t}+\\vec{X}^{*} e^{-j \\omega t} \\qquad (3) $$ Equation (3) makes sure that that the resulting function is real. Now, let find out the relationship between equation (1) and (3).\nLet say\n$$ \\vec{X}=|\\vec{X}| e^{j \\psi} $$ then\n$$ % f(t) =|\\vec{X}| e^{j \\psi} e^{j \\omega t}+|\\vec{X}|^{*} e^{-j \\psi} e^{-j \\omega t} =|\\vec{X}| e^{j(\\psi+\\omega t)}+|\\vec{X}|^{*} e^{-j(\\psi+\\omega t)} \\\\ f(t)=2|\\vec{X}| \\cos (\\omega t+\\psi) $$ so we have\n$$ |\\vec{X}| =\\frac{A}{2} \\qquad \\psi =\\phi $$ Next, finding the relationship between equation (2) and (3).\nAlternatively, we could write\n$$ \\vec{X}=x+j y \\qquad \\text{where} \\quad x=|\\vec{X}| \\cos (\\psi) \\qquad y=|\\vec{X}| \\sin (\\psi) $$ thus\n$$ f(t)=\\vec{X} e^{j \\omega t}+\\vec{X}^{*} e^{-j \\omega t} = x\\left(e^{j \\omega t}+e^{-j \\omega t}\\right)+j y\\left(e^{j \\omega t}-e^{-j \\omega t}\\right) \\\\ f(t) =2 x \\cos (\\omega t)-2 y \\sin (\\omega t) $$ Finally, we get\n$$ B = 2x \\qquad C = -2y \\qquad \\vec{X} = \\frac{B}{2} - j \\frac{C}{2} $$ 1.3. Summary # Since\n$$ % (\\vec{X} e^{j \\omega t})^{*} = \\vec{X}^{*} e^{-j \\omega t} $$ expression (3) and (4) are equivalent. It is advantageous to use one or the other of them, according to circumstances.\nIt\u0026rsquo;s easy to notice that $\\vec{X}$ is time-independent. This conclusion is used when forming the relationship between voltage and current of inductor and capacitor elements.\nSinusoidal form Complex number form $\\vec{X}$ $f(t)=A \\cos (\\omega t+\\phi)$ $f(t)=\\vec{X} e^{j \\omega t}+\\vec{X}^{*} e^{-j \\omega t} \\quad (3)$ $\\vec{X}={A}/{2} \\angle \\phi$ $f(t)=B \\cos (\\omega t)+C \\sin (\\omega t)$ $f(t)=Re(2\\vec{X} e^{j \\omega t}) = Re(A e^{j \\phi} e^{j \\omega t})\\quad (4)$ $\\vec{X} = {B}/{2} - j {C}/{2}$ Strategy:\nTransform the input In into complex polar form $In \\angle \\phi$ Calculate impedance complex number $Z$ Transform output Out into polar form $O \\angle \\alpha$ Using expression (4) to find out $Out(t)$ 2. Impedance # Consider two elements, inductances and capacitances.\nInducatance (L) Capacitance (C) Current is lagging voltage. (L means Lower â†˜ï¸) Current is leading voltage $v_L = L {di}/{dt}$ $i = C ; {dV_C}/{dt}$ $v = \\vec{V}e^{j \\omega t} + \\vec{V}^{*} e^{-j \\omega t}$ $i = \\vec{I}e^{j \\omega t} + \\vec{I}^{*} e^{-j \\omega t}$ $\\vec{V}=j \\omega L \\vec{I} = \\vec{Z}_L ; \\vec{I} \\quad \\text{where } \\vec{Z}_L = j \\omega L$ $\\vec{I}=j \\omega C \\vec{V} = \\vec{V} / \\vec{Z}_C \\quad \\text{where } \\vec{Z}_C = 1 / (j \\omega C)$ The inverse of impedance is admittance\n$$ \\vec{Y} = 1/ \\vec{Z} $$ Example # Suppose we are to find the voltage $v(t)$ in the network, in which $i(t) = I cos(\\omega t)$ Step 1. Transform the input In into complex polar form $In \\angle \\phi$\n$$ i(t) = Re(I e^{\\omega t}) $$ Step 2. Calculate impedance complex number $$ Z _| = \\frac{R j \\omega L}{R + j \\omega L} = \\frac{R \\omega L}{\\sqrt{R^2 + (\\omega L)^2}} \\angle (arctan \\frac{R}{\\omega L}) $$\nStep 3. We found the output voltage in the polar-exponential form\n$$ V = Z_| I = \\frac{IR \\omega L}{\\sqrt{R^2 + (\\omega L)^2}} \\angle (arctan \\frac{R}{\\omega L}) $$\nStep 4. Using expression (4) to find out $v(t)$\n$$ v(t) = \\frac{IR \\omega L}{\\sqrt{R^2 + (\\omega L)^2}} cos ( \\omega t + arctan \\frac{R}{\\omega L}) $$\nReferences # James Kirtley Jr.. 6.061 Introduction to Electric Power Systems. Spring 2011. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu. License: Creative Commons BY-NC-SA.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"}),e.add({id:9,href:"/blog/the-fundamental-of-dc-ac-inverter/",title:"The fundamental of DC-AC inverter",description:"Single-phase and three-phase PWM inverter.",content:"Table of contents\nGetting started 1. Full-brige inverters 1.1. Biploar PWM 1.2. Unipolar PWM 1.3. Hybrid PWM References 2. Vector space and three-phase inverter 3. Power losses and heating design of an DC-AC inverter Switching losses 4. References Refer 1 for more details.\nGetting started # Switch utilization\n$$ \\frac{P_o}{P_T} = \\frac{V_{o1,max} \\times I_{o1,max}}{q \\times V_T \\times I_T} $$\nWhere\n$V_{o1,max}, I_{o1,max}$ are the maximum rated output voltage and current. $V_T, I_T$ are the peak voltage rating and peak current rating of a switching device. $q$ is the number of switches. 1. Full-brige inverters # TL;DR\nUnipolar by definition: having or oriented in respect to a single pole. Bipolar by definiton: having or involving the use of two poles or polarities. $$ \\begin{align*} \u0026 \\text{Control signal: } V_{control}(t) = ð‘€ \\times sin(\\omega t) \\\\ \u0026 \\text{Carrier signal: } V_{tri}(t) = \\left\\{\\begin{matrix} \\cfrac{4}{T_{sw} t} \\qquad t \\in [0,\\cfrac{T_{sw}}{4}] \\cup [\\cfrac{3T_{sw}}{4},T_{sw}] \\\\ -\\cfrac{4}{T_{sw} t} +2 \\qquad t \\in [\\cfrac{T_{sw}}{4},\\cfrac{3T_{sw}}{2}] \\end{matrix}\\right. \\\\ \u0026 \\text{Output peak voltage } V_{out} = M \\times V_{DC} \\end{align*} $$ Where:\n$M$ is mudulation index. $\\omega$ is fundamental frequency. $f_{sw} = 1 / T_{sw}$ is switching frequency. Refer to 2 for LTspice simulation instruction.\n1.1. Biploar PWM # S1 and S4 turn on and turn off at the same time.\nSimulation result: 1.2. Unipolar PWM # The inverter output voltage switches between either between $0 \\rightarrow +Vd$ during half cycle and $0 \\rightarrow -Vd$ half cycle of the fundamental frequency thus this scheme is called unipolar modulation.\n1.3. Hybrid PWM # Refer to 3\nReferences # 2. Vector space and three-phase inverter # 3. Power losses and heating design of an DC-AC inverter # Power losses of an inverter is defined as\n$$ P_{Loss} = P_{in} - P_{out} $$\nWe could measure the losses in two ways.\nDirect measure $P_{in}$ and $P_{out}$. The stability of this method is difficult to achieve. A small variant in input or output could lead to a large error. Indrect by using Calorimetric methos. Highest accuracy is achieved, but it is complicate to operate. A alternative of measuring the losses is deriving the losses. The losses can be calculated by estimate of 4 types of power losses.\nSwitching losses Conducting Losses Blocking losses (neglecgable) Driving losses (neglecable) The rule of thumb for a good design is 50% of switching losses and 50% of conducting losses. Let take a closer look at the three-phase inverter.\n$$ P_{conduction} = \\frac{1}{2 \\pi} \\int_{0}^{2 \\pi} v (\\omega t) i (\\omega t) dt $$\nPower switch is only conducting for half of period.\n$$ \\begin{align*} \u0026 P_C^{IGBT} = \\frac{1}{2 \\pi} \\int_{0}^{\\pi} \\left[ V_{CE,0} \\cdot i_{IGBT}(\\omega t) + R_{CE} \\cdot i_{IGBT}^2 (\\omega t) \\right] dt \\\\ \u0026 P_C^{MOSFET} = \\frac{1}{2 \\pi} \\int_0^{\\pi} \\left [ r_{ds} \\cdot i_{MOS}^2 (\\omega t) \\right ] dt \\\\ \u0026 P_C^{Diode} = \\frac{1}{2 \\pi} \\int_0^{\\pi} \\left [ V_{Forward} \\cdot i_{diode} (\\omega t) + R_F \\cdot i_{diode}^2 (\\omega t) \\right] dt \\end{align*} $$ $$ \\text{Note: } V_{CE,0}, ; R_{CE}, ; R_{DS}, ;V_{F,0}, ; R_{F} \\text{ are from the datasheets of Mosfet/IGBT/Diode.} $$\nUsing Kirchhoff\u0026rsquo;s current law, we have,\n$$ i_{IGBT} (\\omega t) + i_{Diode} (\\omega t) = \\hat{i}_N ; sin(\\omega t) $$\nwhere:\n$$ \\begin{align*} \u0026 i_{IGBT}(\\omega t) = m_{IGBT} (\\omega t) \\cdot \\hat{i}_N \\; sin(\\omega t) \\qquad (1) \\newline \u0026 i_{Diode}(\\omega t) = m_{Diode} (\\omega t) \\cdot \\hat{i}_N \\; sin (\\omega t) \\end{align*} $$ In case of Sine-triangle PWM modulation, modulation function $m = M \\cdot sin(\\omega t + \\phi)$ with $M$ is modulation index.\n$$ \\begin{align*} \u0026 m_{IGBT} - m_{Diode} = m \\qquad (2) \\\\ \u0026 m_{IGBT} + m_{Diode} = 1 \\end{align*} $$ we have,\n$$ \\begin{align*} \u0026m_{IGBT} = \\frac{1+m}{2} = \\frac{1}{2} \\left( 1 + M \\cdot sin(\\omega t) \\right) \\qquad (3) \\\\ \u0026m_{Diode} = \\frac{1-m}{2} = \\frac{1}{2} \\left( 1 - M \\cdot sin(\\omega t) \\right) \\end{align*} $$ Replace equation (1) by equation (3) we get,\n$$ i_{IGBT} (\\omega t) = \\frac{1}{2} \\left[ 1 + M \\cdot sin(\\omega t) \\right] \\hat{i}_N \\; sin(\\omega t) \\newline i_{Diode} (\\omega t) = \\frac{1}{2} \\left[ 1 - M \\cdot sin(\\omega t) \\right] \\hat{i}_N \\; sin(\\omega t) $$ Finally, we get the important formular for conduction losses.\n$$ \\begin{align*} \u0026 P^{IGBT}_{C} = \\frac{\\hat{i_N} \\cdot V_{CE,0}}{2 \\pi} \\left( 1 + \\frac{M \\cdot \\pi}{4} cos \\phi \\right) + \\frac{R_{CE} \\cdot \\hat{i_N}^2}{2 \\pi} (\\frac{\\pi}{4} + \\frac{2M}{3} cos\\phi) \\newline \u0026 P^{MOS}_C = \\frac{R_{DS} \\cdot \\hat{i_N}^2}{2 \\pi} (\\frac{\\pi}{4} + \\frac{2M}{3} cos\\phi) \\qquad (V_{CE,0} = 0) \\newline \u0026 P^{Diode}_C = \\frac{\\hat{i_N} \\cdot V_{F,0}}{2 \\pi} \\left( 1 - \\frac{M \\cdot \\pi}{4} cos \\phi \\right) + \\frac{R_{F} \\cdot \\hat{i_N}^2}{2 \\pi} (\\frac{\\pi}{4} - \\frac{2M}{3} cos\\phi) \\end{align*} $$ Since $R_{DS} \\gg R_{CE}$, we could say that $P_C^{MOS}$ is not smaller than $P_C^{IBGT}$.\nSwitching losses # $$ \\begin{align*} \u0026amp; P_{SW,IGBT} = \\frac{1}{\\pi} f_{SW} (E_{on} + E_{off}) \\frac{V_{DC}}{V_{ref}} \\frac{\\hat{i_N}}{i_{ref}} \\ \u0026amp; P_{SW,Diode} = \\frac{1}{\\pi} f_{SW} E_{rec} \\frac{V_{DC}}{V_{ref}} \\frac{\\hat{i_N}}{i_{ref}} \\ \u0026amp; \\text{ where } E_{rec} = \\frac{1}{2} V_{rr} \\times Q_{rr} \\end{align*} $$\n4. References # David Perreault. 6.334 Power Electronics. Spring 2007. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu. License: Creative Commons BY-NC-SA.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nSimulation of Bridge Inverter in LTspice MOSFET Power Losses Calculation Using the DataSheet Parameters\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nLai, R.S. and Ngo, K.D., 1995. A PWM method for reduction of switching loss in a full-bridge inverter. IEEE Transactions on Power Electronics, 10(3), pp.326-332.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"}),e.add({id:10,href:"/blog/connecting-raspberry-pi-zero-not-w-to-the-internet/",title:"Connecting Raspberry Pi Zero (not W) to the Internet",description:"How to connect Pi Zero to the Internet without using any extra components.",content:`Raspi Zero (not W) have neither Wi-Fi nor Ethernet, so how could we want to update your raspbian without remove the microSD card?
Well, you can create a virtual Ethernet interface. This method is tested on Window 10, you could get the same idea when using Linux/Mac computer.
I am testing 2022-01-28-raspios-bullseye-armhf-lite image version.
pi@raspberrypi:~ \$ uname -a Linux raspberrypi 5.10.92+ #1514 Mon Jan 17 17:35:21 GMT 2022 armv6l GNU/Linux pi@raspberrypi:~ \$ cat /proc/device-tree/model Raspberry Pi Zero Rev 1.3 Table of contents
1. Update cmdline.txt and config.txt settings 2. Script to create a virtual UDC ethernet interface 3. Window settings for Internet Connection Sharing 4. References The network topology I\u0026rsquo;m going to deploy it as follows.
1. Update cmdline.txt and config.txt settings # This method is using libcomposite, so you need to include libcomposite in the modules-load directive as the following. For other methods, please visit gbaman/HowToOTG.md.
root@raspberrypi:/home/pi# cat /boot/cmdline.txt console=serial0,115200 console=tty1 root=PARTUUID=22e47bc0-02 rootfstype=ext4 fsck.repair=yes rootwait modules-load=dwc2,libcomposite Add dtoverlay=dwc2 at the end of /boot/config.txt
root@raspberrypi:/home/pi# cat /boot/config.txt # # Omitted # [cm4] # Enable host mode on the 2711 built-in XHCI USB controller. # This line should be removed if the legacy DWC2 controller is required # (e.g. for USB device mode) or if USB support is not required. otg_mode=1 [all] [pi4] # Run as fast as firmware / board allows arm_boost=1 [all] # Enable UART enable_uart=1 dtoverlay=dwc2 2. Script to create a virtual UDC ethernet interface # The script below will create a virtual UDC ethernet interface.
ðŸ‘‰ In order to make Pi Zero to become plug-and-play as much as possible, I am faking IBM Corporation RNDIS Driver on Window because of lacking the Linux Driver on the Window 7. If you are using MacOS/Linux, you should change OS_CONFIG to macos/linux accordingly. #!/bin/sh # # Thanks to # wismna: http://github.com/wismna/raspberry-pi/hackpi # RoganDawes: https://github.com/RoganDawes/P4wnP1 # https://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/enumeration-of-the-composite-parent-device # https://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/usb-common-class-generic-parent-driver OS_CONFIG=\u0026quot;window\u0026quot; IP_SELF=\u0026quot;192.168.137.2\u0026quot; IP_HOST=\u0026quot;192.168.137.1\u0026quot; MAC_HOST=\u0026quot;48:6f:73:74:50:43\u0026quot; # \u0026quot;Mac address for host PC\u0026quot; MAC_SELF=\u0026quot;42:61:64:55:53:42\u0026quot; # \u0026quot;MAC address for PiZero\u0026quot; CONFIG=/sys/kernel/config/usb_gadget/PiZero mkdir -p \u0026quot;\$CONFIG\u0026quot; cd \u0026quot;\$CONFIG\u0026quot; || exit 1 # 0x04b3 = 1203 # { # \u0026quot;name\u0026quot;: \u0026quot;IBM Corporation\u0026quot;, # \u0026quot;field_vid\u0026quot;: \u0026quot;1203\u0026quot; # }, case \$OS_CONFIG in window) # wismna hack for Window # IBM Corporation RNDIS Driver will be loaded echo 0x04b3 \u0026gt; idVendor echo 0x4010 \u0026gt; idProduct ;; *) echo 0x1d6b \u0026gt; idVendor # Linux Foundation echo 0x0104 \u0026gt; idProduct # Multifunction Composite Gadget ;; esac echo 0x0100 \u0026gt; bcdDevice echo 0x0200 \u0026gt; bcdUSB # Mandatory for Multiple Gadgets echo 0xEF \u0026gt; bDeviceClass echo 0x02 \u0026gt; bDeviceSubClass echo 0x01 \u0026gt; bDeviceProtocol echo 0x40 \u0026gt; bMaxPacketSize0 mkdir -p strings/0x409 mkdir -p configs/c.1/strings/0x409 echo 100000000d2386db \u0026gt; strings/0x409/serialnumber echo \u0026quot;PiZero Project\u0026quot; \u0026gt; strings/0x409/manufacturer echo \u0026quot;PiZero \u0026quot; \u0026gt; strings/0x409/product echo 250 \u0026gt; configs/c.1/MaxPower echo \u0026quot;PiZero\u0026quot; \u0026gt; configs/c.1/strings/0x409/configuration config_acm(){ mkdir -p functions/acm.usb0 ln -s functions/acm.usb0 configs/c.1/acm.usb0 } # Ethernet Adapter #------------------------------------------- config_rndis () { mkdir -p functions/rndis.usb0 echo \$MAC_HOST \u0026gt; functions/rndis.usb0/host_addr echo \$MAC_SELF \u0026gt; functions/rndis.usb0/dev_addr mkdir -p os_desc echo \u0026quot;0x80\u0026quot; \u0026gt; configs/c.1/bmAttributes echo \u0026quot;1\u0026quot; \u0026gt; os_desc/use echo \u0026quot;0xbc\u0026quot; \u0026gt; os_desc/b_vendor_code echo \u0026quot;MSFT100\u0026quot; \u0026gt; os_desc/qw_sign mkdir -p functions/rndis.usb0/os_desc/interface.rndis echo \u0026quot;RNDIS\u0026quot; \u0026gt; functions/rndis.usb0/os_desc/interface.rndis/compatible_id echo \u0026quot;5162001\u0026quot; \u0026gt; functions/rndis.usb0/os_desc/interface.rndis/sub_compatible_id ln -s functions/rndis.usb0 configs/c.1/ ln -s configs/c.1/ os_desc } config_ecm () { mkdir -p functions/ecm.usb0 echo \$MAC_HOST \u0026gt; functions/ecm.usb0/host_addr echo \`MAC_SELF \u0026gt; functions/ecm.usb0/dev_addr ln -s functions/ecm.usb0 configs/c.1/ } case \`OS_CONFIG in window) config_rndis ;; macos | linux) config_ecm ;; *) config_acm ;; esac udevadm settle -t 5 || : ls /sys/class/udc \u0026gt; UDC ifconfig usb0 \`IP_SELF netmask 255.255.255.252 up route add -net default gw \`IP_HOST ðŸ‘‰ I am using 192.168.137.2 address because when I enable Internet Connection Sharing (ICS) on my Wi-Fi adapter, the second NIC get shared Internet will get 192.168.137.1 as you can see in the following steps. You should change the IP address accordingly to your situation. Save the file as runme.sh, and don\u0026rsquo;t forget to change its permission to executable file.
root@raspberrypi:/home/pi# chmod +x runme.sh In order to get the script run at boot up, one simple way is adding this script into rc.local. See more ways to do this at How to Run a Raspberry Pi Program on Startup.
root@raspberrypi:/home/pi# cat /etc/rc.local #!/bin/sh -e # # Omitted # # Print the IP address _IP=\$(hostname -I) || true if [ \u0026quot;\$_IP\u0026quot; ]; then printf \u0026quot;My IP address is %s\\n\u0026quot; \u0026quot;\`_IP\u0026quot; fi /home/pi/runme.sh \u0026amp; exit 0 If you want to ssh to your PiZero, you could enable SSHD for later use.
sudo systemctl enable ssh sudo systemctl start ssh It is time to reboot your PI to apply these settings.
3. Window settings for Internet Connection Sharing # Go to Control Panel\\Network and Internet\\Network Connections. If everything is good, you should see a new Ethernet Adapter (i.e., Ethernet 4 in my case).
Now, you need to share the Internet from your main NIC to the new created NIC by PiZero.
Right click on NIC icon choose Properties, go to Properties one more and then Sharing tab. Check the Allow Other Network Users ... check box. Under Home networking connection, choose the new NIC (i.e., Ethernet 4 in my case) Click OK You will see a pop-up states that Ethernet 4 IP address will be changed to 19.268.137.1. That is why I used this IP address in the above runme.sh script.
Try to connect from your PC to your Pi Zero. I am using SSH to connect because I already enabled SSHD service on PiZero.
C:\\Windows\\system32\u0026gt;ssh pi@192.168.137.2 The authenticity of host '192.168.137.2 (192.168.137.2)' can't be established. ECDSA key fingerprint is SHA256:LxSEz/DS/6u6EQQWI+rr. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '192.168.137.2' (ECDSA) to the list of known hosts. pi@192.168.137.2's password: Linux raspberrypi 5.10.92+ #1514 Mon Jan 17 17:35:21 GMT 2022 armv6l pi@raspberrypi:~ \$ pi@raspberrypi:~ \$ ping google.com PING google.com (216.58.207.206) 56(84) bytes of data. 64 bytes from arn11s04-in-f14.1e100.net (216.58.207.206): icmp_seq=1 ttl=58 time=16.7 ms 64 bytes from arn11s04-in-f14.1e100.net (216.58.207.206): icmp_seq=2 ttl=58 time=16.4 ms ^C --- google.com ping statistics --- 2 packets transmitted, 2 received, 0% packet loss, time 1002ms rtt min/avg/max/mdev = 16.397/16.525/16.654/0.128 ms In case you have problem with the DNS, try to change the DNS server on PiZero by editing /etc/resolv.conf file.
pi@raspberrypi:~ \$ cat /etc/resolv.conf # Generated by resolvconf nameserver 8.8.8.8 ðŸ‘‰ If it doesn't work, disable antivirus/firewall programs in your computer and try again. You may also need to disable and enable network sharing in your Window computer several times until it works. Done! Now you could use the Internet on your Pi Zero.
4. References # showmewebcam #76 How to Run a Raspberry Pi Program on Startup gbaman/HowToOTG.md `}),e.add({id:11,href:"/blog/lifetime-calculation-of-electrolytic-capacitors/",title:"Lifetime calculation of Electrolytic Capacitors",description:"An example of calculation lifetime of JIANGHAI electrolytic capacitor.",content:"On the process of making new inverter/converter products, we are talking about what type of topology will be used, power losses and cost estimation. It is easy to forgot about the Lifetime of capacitors. This article is quick note how to estimate lifetime of electrolytic capacitor (elcap) provided by JIANGHAI 1. Other manufactures may have different ways to estimate lifetime of these capacitors. Please look up manufacturer application note for more detail.\nTable of contents\nLifetime model Temperature factor Ripple current factor Voltage factor References Lifetime model # The lifetime $L$ of the electrolytic capacitor can be estimated by using numerical lifetime model:\n$$ L = L_0 \\cdot K_T \\cdot K_R \\cdot K_V $$\nwhere\n$L_0$ is specified lifetime from the datasheet of given capacitor at norminal ripple. $K_T$ temperature factor (ambient temperature) $K_R$ ripple current factor (self-heating) $K_V$ voltage factor (operating voltage) Temperature factor # Temperature factor $K_T$ can be calculated based on \u0026ldquo;10-Kelvin-rule\u0026rdquo; that is: a drop of the ambient temperature by $10K$ double the lifetime of capacitor.\n$$ K_T = 2^{\\cfrac {T_O - T_A}{10K}} $$\nWhere\n$T_0$ rated temperature $T_A$ ambient temperature Ripple current factor # Ripple current factor $K_R$ is calculated as following.\n$$ K_R = K_i^{A \\cdot \\cfrac{\\Delta T_0}{10K}} $$\nwhere\n$A = 1 - (\\frac{I_A}{I_R})^2$ $I_A$ ripple current in the application $I_R$ rated ripple current $\\Delta T_0$ core temperature increase of the elcap $T_0=105 ^{\\circ}C$ typ. 3.5~5K $T_0 = 85 ^\\circ C$ typ. 3.5~10K $K_i$ empirical safety factor $T_0=105 ^{\\circ}C$ if ($I\u0026gt;I_R$) then $K_i = 4$ else $K_i = 2$ $T_0 = 85 ^\\circ C \\rightarrow K_i = 2$ Voltage factor # There are two cases need to take into account when calculate voltage factor $K_V$.\nIf $0.6 \\le \\cfrac{U_A}{U_R} \\le 1$ then $$ K_V = \\left( \\cfrac{U_A}{U_R} \\right) ^{-2.5} $$ else $$ K_V = 3.59 $$\nwhere\n$U_R$ rated voltage $U_A$ actual operating voltage References # Albertsen, A. 2010. Electrolytic capacitor lifetime estimation [Online]. JIANGHAI Eur. GmbH. Available: https://jianghai-europe.com/wp-content/uploads/Jianghai-Europe-E-Cap-Lifetime-Estimation-long-AAL-2018-09-18.pdf [Accessed March 3, 2022].\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n"}),e.add({id:12,href:"/blog/mosfet-and-igbt/",title:"MOSFET and IGBT",description:"MOSFET and IGBT structure and how to use them properly.",content:`Table of contents
N-channel MOSFET Physical view Electrical view Circuit symbol N-channel MOSFET References N-channel MOSFET # Physical view # Current flows between diffusion terminals if the voltage on the Gate large enough to create a conducting channel, otherwise the MOSFET is off and the diffusion terminals are not connected. 1
Electrical view # The four terminals of a Field Effect Transitor are Gate, Source, Drain and Bulk.
Circuit symbol # MOSFET and JFET circuit symbols
P-channel N-channel JFET (they are only in depletion mode) MOSFET enhancement mode MOSFET enhancement mode (no bulk) MOSFET enhancement mode (no bulk) MOSFET depletion mode (switched on) {% include tldr.html box=\u0026ldquo;TRICK\u0026rdquo; tldr=\u0026ldquo;The arrow forms the pn junction from the \u0026lsquo;buck\u0026rsquo; to the \u0026lsquo;gate\u0026rsquo; in the symbol of MOSFET\u0026rdquo; %}
When a channel exists in a MOSFET, current can flow from source to drain as well as from drain to source - it\u0026rsquo;s just a matter of how the device is connected in the circuit 2. Conventional current flows from Drain to Source in an N Channel MOSFET.
N-channel MOSFET # When a channel exists in a MOSFET, current can flow from drain to sourceÂ orÂ from source to drain - it\u0026rsquo;s a function of how the device is connected in the circuit. The conduction channel has no intrinsic polarity - it\u0026rsquo;s kind of like a resistor in that regard.
The intrinsic body diode inside the MOSFET is in parallel with the conduction channel, however. When the conduction channel is present, the diode is shunted and current flows through the path of least resistance (the channel). When the channel is off, the diode is in circuit and will either conduct or block depending on the drain-source current polarity.
As your picture shows, there are both N-channel and P-channel devices, as well as enhancement mode and depletion mode devices. In all of these cases, current can flow from source to drain as well as from drain to source - it\u0026rsquo;s just a matter of how the device is connected in the circuit.
Your picture doesÂ notÂ show the intrinsic diode in the devices - the arrow point towards or away from the gate is an indication of the channel type (N-channel points towards the gate, P-channel points away from the gate).
This symbol shows you the inherent diode between drain and source.
N-channel enhancement devices need a voltage on the gateÂ higherÂ than the source in order to create a conduction channel. (Enhancement devices don\u0026rsquo;t have a channel automatically, and need gate voltage to create one - because it\u0026rsquo;s N-channelÂ Vgate\u0026gt;VsourceÂ for this to happen.)
P-channel enhancement devices need a voltage on the gateÂ lowerÂ than the source in order to create a conduction channel. (Enhancement devices don\u0026rsquo;t have a channel automatically, and need gate voltage to create one - because it\u0026rsquo;s P-channelÂ Vgate\u0026lt;VsourceÂ for this to happen.)
N-channel delpetion devices have a channel by default, and need a voltage on the gateÂ lowerÂ than the source in order to turn the channelÂ off. The channel can be widened to a certain extent by increasing the gate-to-source voltage above 0.
P-channel depletion devices also have a channel by default, and need a voltage on the gateÂ higherÂ than the source in order to turn the channelÂ off. The channel can be widened to a certain extent by decreasing the gate-to-source voltage below 0.
References # Chris Terman. 6.004 Computation Structures. Spring 2017. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu. License: Creative Commons BY-NC-SA.\u0026#160;\u0026#x21a9;\u0026#xfe0e;
Adam Lawrence, In an NMOS, does current flow from source to drain or vice-versa?, URL (version: 2012-11-11)\u0026#160;\u0026#x21a9;\u0026#xfe0e;
`}),e.add({id:13,href:"/blog/",title:"Blog",description:"The Doks Blog.",content:""}),e.add({id:14,href:"/blog/upgrading-tplink-tl-wr840n-v5-flash-chip/",title:"Upgrading TPLink TL-WR840N v5 flash chip",description:"TPLink TL-WR840N v5 came with only 4Mb of flash, it was not enough for me. I want more functionality on this device, so I decided to upgrade its flash to 8Mb.",content:"Table of content\n1. Pre-requirement 2. Let\u0026rsquo;s do it 2.1 Desolder old flash chip 2.2 Program new flash chip 2.3 Re-solder new flash chip 3. Enjoy I will show you how to upgrade TP-Link flash chip on TP-Link from 4mb to 8mb.\n1. Pre-requirement # New flash chip: I used Winbond 8MiB GD25Q64CSIG Soldering iron: desolder old flash chip and re-solder new flash chip ROM programer and IC socket: I am using CH-341A (~ 5$) One PC/Laptop 2. Let\u0026rsquo;s do it # 2.1 Desolder old flash chip # Hot air soldering station is ideally suited for desoldering flash. If you not, you can follow this video to do this.\n2.2 Program new flash chip # Firstly, you need to choose new flash chip you want to replace. Why I chose Winbond GD25Q64CSIG for replacement, see table bellow:\nDescription Original Mod flash GigaDevice GD25Q32B (4MB) Winbond GD25Q64CSIG (8MB) firmware TL-WR840N(VN)_V5_170517 openwrt-18.06.1-ramips-mt76x8-tl-wr841n-v13-squashfs-sysupgrade I see the name of flash chip is the same, so I didn\u0026rsquo;t checked datasheet for compatible.\nSecondly, you need to choose OpenWRT firmware. Why I used openwrt-18.06.1-ramips-mt76x8-tl-wr841n-v13-squashfs-sysupgrade instead of openwrt-18.06.1-ramips-mt76x8-tl-wr840n-v5-squashfs-sysupgrade?\nBecause it used the same CPU and different in flash and RAM chip.\nDescription TP-LINK TL-WR841N v13.x TP-LINK TL-WR840N v5 CPU MediaTek MT7628NN (580MHz) MediaTek MT7628NN @575MHz RAM Winbond W9751G6JB-25 (64MB) ESMT M14D5121632A (64MB) Flash GigaDevice GD25Q64CSIG (8MB) GigaDevice GD25Q32B (4MB) ðŸ‘‰ You are able to use openwrt-18.06.1-ramips-mt76x8-tl-**wr840n-v5**-squashfs-sysupgrade with 8MB flash chip, your router still booting but you can not any configuration after reboot. You may got error `Your image is probably too big, leaving not enough space for jffs2`. In the first time, I faced this problem. I can not save any configuration after reboot. If you look at boot log, it read:\nfixed-partitions partitions found on MTD device spi0.0 Creating 3 MTD partitions on \u0026quot;spi0.0\u0026quot;: 0x000000000000-0x000000020000 : \u0026quot;boot\u0026quot; 0x000000020000-0x0000003f0000 : \u0026quot;firmware\u0026quot; 2 tplink-fw partitions found on MTD device firmware 0x000000020000-0x00000017d048 : \u0026quot;kernel\u0026quot; 0x00000017d048-0x0000003f0000 : \u0026quot;rootfs\u0026quot; mtd: device 3 (rootfs) set to be root filesystem 1 squashfs-split partitions found on MTD device rootfs 0x0000003b0000-0x0000003f0000 : \u0026quot;rootfs_data\u0026quot; 0x0000003f0000-0x000000400000 : \u0026quot;factory\u0026quot; m25p80 spi0.0: s25fl064k (8192 Kbytes) VFS: Mounted root (squashfs filesystem) readonly on device 31:3. Freeing unused kernel memory: 208K This architecture does not have kernel memory protection. init: Console is alive init: - watchdog - random: fast init done kmodloader: loading kernel modules from /etc/modules-boot.d/* kmodloader: done loading kernel modules from /etc/modules-boot.d/* init: - preinit - rt3050-esw 10110000.esw: link changed 0x00 random: procd: uninitialized urandom read (4 bytes read) jffs2: Too few erase blocks (4) --\u0026gt; Your image is probably too big, leaving not enough space for jffs2. mount_root: failed to mount -t jffs2 /dev/mtdblock4 /tmp/overlay: Invalid argument mount_root: overlay filesystem has not been fully initialized yet mount_root: switching to jffs2 overlay mount_root: switching to jffs2 failed - fallback to ramoverlay urandom-seed: Seed file not found (/etc/urandom.seed) No /overlay will be mounted:\nroot@OpenWrt:~# df -h Filesystem Size Used Available Use% Mounted on /dev/root 2.3M 2.3M 0 100% /rom tmpfs 29.5M 532.0K 29.0M 2% /tmp tmpfs 29.5M 56.0K 29.5M 0% /tmp/root overlayfs:/tmp/root 29.5M 56.0K 29.5M 0% / tmpfs If everything is good, it should be like this:\nroot@OpenWrt:~# df -h Filesystem Size Used Available Use% Mounted on /dev/root 2.3M 2.3M 0 100% /rom tmpfs 29.5M 540.0K 29.0M 2% /tmp /dev/mtdblock4 4.1M 304.0K 3.8M 7% /overlay overlayfs:/overlay 4.1M 304.0K 3.8M 7% / tmpfs 512.0K 0 512.0K 0% /dev root@OpenWrt:~# root@OpenWrt:~# cat /proc/mtd dev: size erasesize name mtd0: 00020000 00010000 \u0026quot;boot\u0026quot; mtd1: 007a0000 00010000 \u0026quot;firmware\u0026quot; mtd2: 0015d05b 00010000 \u0026quot;kernel\u0026quot; mtd3: 00642fa4 00010000 \u0026quot;rootfs\u0026quot; mtd4: 00410000 00010000 \u0026quot;rootfs_data\u0026quot; mtd5: 00010000 00010000 \u0026quot;config\u0026quot; mtd6: 00030000 00010000 \u0026quot;factory\u0026quot; Now, you have new flash chip and suitable firware, but you can not use this firware to program new flash chip. Because RAW flash need more partion than firmware such as: bootloader and art. See more in here\nYou can use bellow shell script to generate firmware for any flash with different capacity.\nset -e flash_size_in_MB=8 sysupgrade_OpenWRT=\u0026quot;openwrt-18.06.1-ramips-mt76x8-tl-wr840n-v5-squashfs-sysupgrade.bin\u0026quot; art_file=\u0026quot;upload_openwrt_art.bin\u0026quot; boot_loader=\u0026quot;upload_openwrt_mtd0.bin\u0026quot; sysupgrade_OpenWRT_size=$(wc -c $sysupgrade_OpenWRT | cut -f 1 -d \u0026quot; \u0026quot;) art_file_size=$(wc -c $art_file | cut -f 1 -d \u0026quot; \u0026quot;) boot_loader_size=$(wc -c $boot_loader | cut -f 1 -d \u0026quot; \u0026quot;) echo \u0026quot;sysupgrade_OpenWRT_size: \u0026quot; $sysupgrade_OpenWRT_size echo \u0026quot;art_file_size: \u0026quot; $art_file_size echo \u0026quot;boot_loader_size: \u0026quot; $boot_loader_size padcount=$(($flash_size_in_MB * 1024 * 1024 - $boot_loader_size - $art_file_size - $sysupgrade_OpenWRT_size)) echo \u0026quot; Write boot loader\u0026quot; dd if=$boot_loader bs=512 \u0026gt;\u0026gt; \u0026quot;${sysupgrade_OpenWRT}_dump\u0026quot;.bin echo \u0026quot;Write firmware\u0026quot; dd if=$sysupgrade_OpenWRT bs=512 \u0026gt;\u0026gt; \u0026quot;${sysupgrade_OpenWRT}_dump\u0026quot;.bin echo \u0026quot;Write padding FF\u0026quot; dd if=/dev/zero ibs=1 count=\u0026quot;$padcount\u0026quot; | tr \u0026quot;\\000\u0026quot; \u0026quot;\\377\u0026quot; \u0026gt;\u0026gt; \u0026quot;${sysupgrade_OpenWRT}_dump\u0026quot;.bin echo \u0026quot;Write art partition\u0026quot; dd if=$art_file bs=512 \u0026gt;\u0026gt; \u0026quot;${sysupgrade_OpenWRT}_dump\u0026quot;.bin parameter Description flash_size_in_MB new flash chip capacity sysupgrade_OpenWRT OpenWRT image (firmware) art_file ART partion from original flash, the last 64k block of the chip no matter what the chip size. boot_loader bootloader, the first 128kB from original flash Output firmware sysupgrade_OpenWRT_dump.bin, you can use this to program your new flash chip If you don\u0026rsquo;t want to use this script, you can create image by yourself. You may to need hex editor like HxDen to do this.\nAll file which I used in here\n2.3 Re-solder new flash chip # After use CH341A to program new flash chip, you can re-solder new flash chip on target board.\nðŸ‘‰ If your board can not booting, don't worry. You can use [Clip Socket Adapter](https://www.ebay.com/itm/SOIC8-SOP8-Flash-Chip-IC-Test-Clip-Socket-Adapter-BIOS-CH341A-USB-Programmer-/372555847443) to try program flash again with out desolder chip. 3. Enjoy # ðŸ‘‰ I used image come from **TL-WR841N v13.x**, except for LED will not working, everything work well (Wi-Fi, Ethernet, Router feature). "}),search.addEventListener("input",t,!0);function t(){const s=5;var n=this.value,o=e.search(n,{limit:s,enrich:!0});const t=new Map;for(const e of o.flatMap(e=>e.result)){if(t.has(e.doc.href))continue;t.set(e.doc.href,e.doc)}if(suggestions.innerHTML="",suggestions.classList.remove("d-none"),t.size===0&&n){const e=document.createElement("div");e.innerHTML=`No results for "<strong>${n}</strong>"`,e.classList.add("suggestion__no-results"),suggestions.appendChild(e);return}for(const[r,a]of t){const n=document.createElement("div");suggestions.appendChild(n);const e=document.createElement("a");e.href=r,n.appendChild(e);const o=document.createElement("span");o.textContent=a.title,o.classList.add("suggestion__title"),e.appendChild(o);const i=document.createElement("span");if(i.textContent=a.description,i.classList.add("suggestion__description"),e.appendChild(i),suggestions.appendChild(n),suggestions.childElementCount==s)break}}})()