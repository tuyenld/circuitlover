<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://circuitlover.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://circuitlover.com/" rel="alternate" type="text/html" /><updated>2022-05-01T16:08:41+00:00</updated><id>https://circuitlover.com/feed.xml</id><title type="html">circuitlover.com</title><subtitle>A blog from Dinh-Tuyen Le.</subtitle><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><entry><title type="html">Classical Control Theory</title><link href="https://circuitlover.com/classical-control-theory/" rel="alternate" type="text/html" title="Classical Control Theory" /><published>2022-04-30T00:00:00+00:00</published><updated>2022-04-30T00:00:00+00:00</updated><id>https://circuitlover.com/classical-control-theory</id><content type="html" xml:base="https://circuitlover.com/classical-control-theory/">&lt;h1 id=&quot;1-some-useful-functions&quot;&gt;1. Some useful functions&lt;/h1&gt;
&lt;p&gt;Step function&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/step-function.jpg&quot; alt=&quot;step-function&quot; /&gt;&lt;/p&gt;

\[\begin{align*}
    u(t)={\begin{cases}1&amp;amp;{\text{if }}t \ge 0 \\0&amp;amp;{\text{if }}t \lt 0\\\end{cases}}
    \qquad
    u[n]={\begin{cases}1&amp;amp;{\text{if }}n \ge 0 \\0&amp;amp;{\text{if }}n \lt 0\\\end{cases}}
\end{align*}\]

&lt;p&gt;Impulse unit function (in descrete domain)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/impulse-function.jpg&quot; alt=&quot;Impulse function&quot; /&gt;&lt;/p&gt;

\[\begin{align*}
    &amp;amp; \delta[n]={\begin{cases}1&amp;amp;{\text{if }}n = 0 \\0&amp;amp;{\text{if }}n \ne 0\\\end{cases}} \\
    &amp;amp; u[n] = \sum_{k = 0}^{\infty} \delta[n-k] \qquad \text{for step function} \\
    &amp;amp; x[n] = \sum_{k = - \infty}^{\infty} x[k] \delta[n-k] \qquad \text{for arbitrary function}
\end{align*}\]

&lt;p&gt;We will use this relation later on.&lt;/p&gt;

&lt;h1 id=&quot;2-what-are-linear-and-time-invariance-lti-systems&quot;&gt;2. What are “Linear and Time Invariance” (LTI) systems?&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/LTI-system.jpg&quot; alt=&quot;LTI system&quot; /&gt;&lt;/p&gt;

&lt;p&gt;An example of LTI system.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/LTI-example.jpg&quot; alt=&quot;LTI example&quot; /&gt;&lt;/p&gt;

&lt;p&gt;What is &lt;strong&gt;Laplace transformation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/Laplace-transform.png&quot; alt=&quot;Laplace transformation&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Q. What is impulse response $h[n]$ of a system?&lt;br /&gt;
A. When the input is a impulse unit function $\delta [n]$ (see “Impulse unit function” section above)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/impulse-response.jpg&quot; alt=&quot;impulse responses&quot; /&gt;&lt;/p&gt;

\[\begin{align*}
    &amp;amp; \delta [n]\overset L \longrightarrow h[n] \qquad \text{ OR } \qquad y[n] = T\{x[n]\} \\
    &amp;amp; x[n] = \sum_{k = - \infty}^{\infty} x[k] \delta[n-k] \\
    &amp;amp; \Rightarrow y[n]=T \{ \sum_{k = - \infty}^{\infty} x[k] \delta[n-k] \} \overset {LTI} \longrightarrow  \sum_{k = - \infty}^{\infty} x[k] L \{\delta[n-k] \} \\
    &amp;amp; \Rightarrow y[n] = \sum_{k = - \infty}^{\infty} x[k]  h[n-k] := x[n] * h[n] \quad \text{(This is convolution)}
\end{align*}\]

&lt;p&gt;Now, if we take a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Laplace&lt;/code&gt; transformation of $y[n]$, we have.&lt;/p&gt;

\[\begin{align*}
    &amp;amp; x [n]\overset L \longrightarrow X[s] \\
    &amp;amp; h [n]\overset L \longrightarrow H[s] \qquad \text{(where h[n] is the impulse response of the system)}\\
    &amp;amp; y [n] = x[n] * h[n] \overset L \longrightarrow Y[s] = X[s] . H[s]
\end{align*}\]

&lt;p&gt;We call $H[s]$ is the &lt;strong&gt;transfer function&lt;/strong&gt; of the system.&lt;/p&gt;

&lt;p&gt;An example of using impulse response in the system.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/impulse-response-example.jpg&quot; alt=&quot;impulse responses example&quot; /&gt;&lt;/p&gt;

&lt;p&gt;From convolution to transfer function.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/convolution-to-transfer-function.jpg&quot; alt=&quot;convolution-to-transfer-function&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/impulse-response-example-2.jpg&quot; alt=&quot;impulse responses example&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let take a step back to understand this picture. In this case, $u(t)$ is input, and $x(t)$ is output. If we take $u(t)=\delta (t)$, we should have $x(t)=X(t)$ at the output. Taking &lt;strong&gt;Laplace&lt;/strong&gt; transformation both side of the equation, $X(s)$ becomes &lt;strong&gt;Transfer function&lt;/strong&gt; of the system.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control/impulse-response-example-explain.jpg&quot; alt=&quot;impulse responses example&quot; /&gt;&lt;/p&gt;

&lt;p&gt;References&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Brian Douglas Youtube &lt;a href=&quot;https://www.youtube.com/user/ControlLectures&quot;&gt;channel&lt;/a&gt;, “Classical Control Theory” &lt;a href=&quot;https://www.youtube.com/playlist?list=PLUMWjy5jgHK1NC52DXXrriwihVrYZKqjk&quot;&gt;series&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Dang Quang Hieu, Digital Signal Processing lecture note&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="control" /><summary type="html">1. Some useful functions Step function</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">AC to DC converter</title><link href="https://circuitlover.com/ac-dc-converter/" rel="alternate" type="text/html" title="AC to DC converter" /><published>2022-03-31T00:00:00+00:00</published><updated>2022-03-31T00:00:00+00:00</updated><id>https://circuitlover.com/ac-dc-converter</id><content type="html" xml:base="https://circuitlover.com/ac-dc-converter/">&lt;p&gt;Table of contents&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#1-one-switch-sigle-ended-forward-converter-isolated-buck-converter&quot;&gt;1. One-switch sigle-ended forward converter (isolated buck converter)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#2-two-switch-sigle-ended-forward-converter-isolated-buck-converter&quot;&gt;2. Two-switch sigle-ended forward converter (isolated buck converter)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#3-practical-consideration&quot;&gt;3. Practical consideration&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#31-how-to-use-impedance-analyzer&quot;&gt;3.1. How to use Impedance Analyzer&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#4-references&quot;&gt;4. References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you don’t know what is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;K1 L1 L2 1&lt;/code&gt; transformer directive means, you should check &lt;sup id=&quot;fnref:lt_transf&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:lt_transf&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; for more details.&lt;/p&gt;

&lt;h1 id=&quot;1-one-switch-sigle-ended-forward-converter-isolated-buck-converter&quot;&gt;1. One-switch sigle-ended forward converter (isolated buck converter)&lt;/h1&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/ac-dc-inverter/forward-basic-topology.png&quot; alt=&quot;forward converter topology&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This is essentially a buck converter with transformer inserted.&lt;/p&gt;

&lt;p&gt;We want to operate in Continuous Conduction Mode.
$I_{Lout}$ never reach zero.&lt;/p&gt;

&lt;p&gt;In DCM we may have &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;peak detect&lt;/code&gt; phenomina, we $V_{out}^{‘} = (3-4) \times V_{out}$&lt;/p&gt;

\[\begin{align*}
&amp;amp; \text{- switch on: } V_{D2} = \frac{N2}{N1} V_{in} \\
&amp;amp; \text{- switch off: } V_{D2} = 0; \\
&amp;amp; \frac{V_{OUT}}{V_{IN}} = \frac{N2}{N1} D
\end{align*}\]

\[\text{Output voltage ripple } V_{ripple} = ESR * \Delta I\]

&lt;p&gt;ESR is from $C_{OUT}$, and $\Delta I$ is effected by the design of $L_{out}$. 
Rule of thumb is $\Delta I$ = 10% to 40% of full load.&lt;/p&gt;

&lt;h1 id=&quot;2-two-switch-sigle-ended-forward-converter-isolated-buck-converter&quot;&gt;2. Two-switch sigle-ended forward converter (isolated buck converter)&lt;/h1&gt;
&lt;p&gt;also called asymmetrical half bridge forward&lt;/p&gt;

&lt;h1 id=&quot;3-practical-consideration&quot;&gt;3. Practical consideration&lt;/h1&gt;
&lt;h2 id=&quot;31-how-to-use-impedance-analyzer&quot;&gt;3.1. How to use Impedance Analyzer&lt;/h2&gt;
&lt;p&gt;The table is adapted from [^4191A].&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/ac-dc-inverter/equivalent-circuit-impedance.png&quot; alt=&quot;Equivalent circuit model selection&quot; /&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Equi. circuit&lt;/th&gt;
      &lt;th&gt;Type of DUTs&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;A&lt;/td&gt;
      &lt;td&gt;(1) Coils with high core loss; (2) To measure magnetizing inductance $L_M$, you need to open the secondary side. Only $L_M,C_1,R_{core}$ left.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;B&lt;/td&gt;
      &lt;td&gt;(1) coils in general; (2) resistors; (3) Measuring leakage inductance $L_{leakage}$, you need to short the secondary side.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;High value resistors&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;D&lt;/td&gt;
      &lt;td&gt;Capacitors&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;E&lt;/td&gt;
      &lt;td&gt;Resonators (crystal, ceramic, ferrite)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;4-references&quot;&gt;4. References&lt;/h1&gt;
&lt;p&gt;[^4191A] Operation manual Model 4191A network/spectrum Analyzer page 141/356 &lt;a href=&quot;https://xdevs.com/doc/HP_Agilent_Keysight/HP%204195A%20Operation.pdf&quot;&gt;Online&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:lt_transf&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;&lt;a href=&quot;https://www.analog.com/en/technical-articles/ltspice-basic-steps-for-simulating-transformers.html&quot;&gt;LTspice: Simple Steps for Simulating Transformers&lt;/a&gt; &lt;a href=&quot;#fnref:lt_transf&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pe" /><summary type="html">Table of contents 1. One-switch sigle-ended forward converter (isolated buck converter) 2. Two-switch sigle-ended forward converter (isolated buck converter) 3. Practical consideration 3.1. How to use Impedance Analyzer 4. References</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Lifetime calculation for Electrolytic Capacitors</title><link href="https://circuitlover.com/capacitor-life-time-cal/" rel="alternate" type="text/html" title="Lifetime calculation for Electrolytic Capacitors" /><published>2022-03-03T00:00:00+00:00</published><updated>2022-03-03T00:00:00+00:00</updated><id>https://circuitlover.com/capacitor-life-time-cal</id><content type="html" xml:base="https://circuitlover.com/capacitor-life-time-cal/">&lt;p&gt;On the process of making new inverter/converter products, we are talking about what type of topology will be used, power losses and cost estimation. It is easy to forgot about the &lt;strong&gt;Lifetime of capacitors&lt;/strong&gt;. This article is quick note how to estimate lifetime of electrolytic capacitor (elcap) provided by &lt;strong&gt;JIANGHAI&lt;/strong&gt; &lt;sup id=&quot;fnref:fn1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:fn1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. Other manufactures may have different ways to estimate lifetime of these capacitors. Please look up manufacturer application note for more detail.&lt;/p&gt;

&lt;p&gt;Table of contents&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#lifetime-model&quot;&gt;Lifetime model&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#temperature-factor-k_t&quot;&gt;Temperature factor $K_T$&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#ripple-current-factor-k_r&quot;&gt;Ripple current factor $K_R$&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#voltage-factor-k_v&quot;&gt;Voltage factor $K_V$&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#references&quot;&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;lifetime-model&quot;&gt;Lifetime model&lt;/h2&gt;

&lt;p&gt;The lifetime $L$ of the electrolytic capacitor can be estimated by using numerical lifetime model:&lt;/p&gt;

\[L = L_0 \cdot K_T \cdot K_R \cdot K_V\]

&lt;p&gt;where&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;$L_0$ is specified lifetime from the datasheet of given capacitor at norminal ripple.&lt;/li&gt;
  &lt;li&gt;$K_T$ temperature factor (ambient temperature)&lt;/li&gt;
  &lt;li&gt;$K_R$ ripple current factor (self-heating)&lt;/li&gt;
  &lt;li&gt;$K_V$ voltage factor (operating voltage)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;temperature-factor-k_t&quot;&gt;Temperature factor $K_T$&lt;/h3&gt;

&lt;p&gt;“10-Kelvin-rule” is wide used in the industry: a drop of the ambient temperature by $10K$ double the lifetime of capacitor.&lt;/p&gt;

\[K_T = 2^{\cfrac {T_O - T_A}{10K}}\]

&lt;p&gt;Where&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;$T_0$ rated temperature&lt;/li&gt;
  &lt;li&gt;$T_A$ ambient temperature&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ripple-current-factor-k_r&quot;&gt;Ripple current factor $K_R$&lt;/h3&gt;

\[K_R = K_i^{A \cdot \cfrac{\Delta T_0}{10K}}\]

&lt;p&gt;where&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;$A = 1 - (\frac{I_A}{I_R})^2$&lt;/li&gt;
  &lt;li&gt;$I_A$ ripple current in the application&lt;/li&gt;
  &lt;li&gt;$I_R$ rated ripple current&lt;/li&gt;
  &lt;li&gt;$\Delta T_0$ core temperature increase of the elcap
    &lt;ul&gt;
      &lt;li&gt;$T_0=105 ^{\circ}C$ typ. 3.5~5K&lt;/li&gt;
      &lt;li&gt;$T_0 = 85 ^\circ C$ typ. 3.5~10K&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;$K_i$ empirical safety factor
    &lt;ul&gt;
      &lt;li&gt;$T_0=105 ^{\circ}C$ if ($I&amp;gt;I_R$) then $K_i = 4$ else $K_i = 2$&lt;/li&gt;
      &lt;li&gt;$T_0 = 85 ^\circ C \rightarrow K_i = 2$&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;voltage-factor-k_v&quot;&gt;Voltage factor $K_V$&lt;/h3&gt;

&lt;p&gt;If $0.6 \le \cfrac{U_A}{U_R} \le 1$ then
\(K_V = \left( \cfrac{U_A}{U_R} \right) ^{-2.5}\)
else
\(K_V = 3.59\)&lt;/p&gt;

&lt;p&gt;where&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;$U_R$ rated voltage&lt;/li&gt;
  &lt;li&gt;$U_A$ actual operating voltage&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;references&quot;&gt;References&lt;/h2&gt;
&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:fn1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Albertsen, A. 2010. Electrolytic capacitor lifetime estimation [Online]. JIANGHAI Eur. GmbH. Available: https://jianghai-europe.com/wp-content/uploads/Jianghai-Europe-E-Cap-Lifetime-Estimation-long-AAL-2018-09-18.pdf [Accessed March 3, 2022]. &lt;a href=&quot;#fnref:fn1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pe" /><summary type="html">On the process of making new inverter/converter products, we are talking about what type of topology will be used, power losses and cost estimation. It is easy to forgot about the Lifetime of capacitors. This article is quick note how to estimate lifetime of electrolytic capacitor (elcap) provided by JIANGHAI 1. Other manufactures may have different ways to estimate lifetime of these capacitors. Please look up manufacturer application note for more detail. Albertsen, A. 2010. Electrolytic capacitor lifetime estimation [Online]. JIANGHAI Eur. GmbH. Available: https://jianghai-europe.com/wp-content/uploads/Jianghai-Europe-E-Cap-Lifetime-Estimation-long-AAL-2018-09-18.pdf [Accessed March 3, 2022]. &amp;#8617;</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Serial protocol through USB on Raspberry Pi</title><link href="https://circuitlover.com/enable-serial-over-usb/" rel="alternate" type="text/html" title="Serial protocol through USB on Raspberry Pi" /><published>2022-03-02T00:00:00+00:00</published><updated>2022-03-02T00:00:00+00:00</updated><id>https://circuitlover.com/enable-serial-over-usb</id><content type="html" xml:base="https://circuitlover.com/enable-serial-over-usb/">&lt;h2 id=&quot;1-download-raspberry-pi-os&quot;&gt;1. Download Raspberry Pi OS&lt;/h2&gt;
&lt;p&gt;I am using the lite version at &lt;a href=&quot;https://downloads.raspberrypi.org/raspios_lite_armhf/images/raspios_lite_armhf-2022-01-28/2022-01-28-raspios-bullseye-armhf-lite.zip&quot;&gt;2022-01-28-raspios-bullseye-armhf-lite image&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /boot/config.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;all]
&lt;span class=&quot;c&quot;&gt;# Enable UART via PIN IO&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;enable_uart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;span class=&quot;nv&quot;&gt;dtoverlay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dwc2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;2-raspberry-pi-settings&quot;&gt;2. Raspberry Pi settings&lt;/h2&gt;

&lt;p&gt;You need to change &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/boot/cmdline.txt&lt;/code&gt; file as follows.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /boot/cmdline.txt
&lt;span class=&quot;nv&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;serial0,115200 &lt;span class=&quot;nv&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;tty1 &lt;span class=&quot;nv&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;22e47bc0-02 &lt;span class=&quot;nv&quot;&gt;rootfstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ext4 fsck.repair&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;yes &lt;/span&gt;rootwait modules-load&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dwc2,g_serial
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Default username/password: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pi/raspberrypi&lt;/code&gt;. Entering sudo mode &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo su&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;getty@ttyGS0.service
systemctl start getty@ttyGS0.service
systemctl is-active getty@ttyGS0.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Reboot your Raspberry Pi to apply these settings.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;reboot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If everything is good, we’ll see a new &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;USB Serial Device&lt;/code&gt; under &lt;strong&gt;Ports (COM &amp;amp; LPT)&lt;/strong&gt; as following picture.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/pi/usb-serial-devices-device-maneger.png&quot; alt=&quot;usb-serial-devices-device-maneger&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Teraterm login via USB.
&lt;img src=&quot;/images/posts/pi/Tera-term-login-via-USB.png&quot; alt=&quot;Teraterm login via USB&quot; /&gt;&lt;/p&gt;

&lt;p&gt;References:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://mike632t.wordpress.com/2020/03/30/configuring-the-pi-zero-usb-port-as-a-serial-device/&quot;&gt;Configuring the Pi Zero USB port as a serial device - mike632t&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://learn.adafruit.com/turning-your-raspberry-pi-zero-into-a-usb-gadget/serial-gadget&quot;&gt;Serial Gadget - adafruit&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pi" /><summary type="html">1. Download Raspberry Pi OS I am using the lite version at 2022-01-28-raspios-bullseye-armhf-lite image</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Control of grid connected inverter</title><link href="https://circuitlover.com/control-of-grid-connected/" rel="alternate" type="text/html" title="Control of grid connected inverter" /><published>2022-02-24T00:00:00+00:00</published><updated>2022-02-24T00:00:00+00:00</updated><id>https://circuitlover.com/control-of-grid-connected</id><content type="html" xml:base="https://circuitlover.com/control-of-grid-connected/">&lt;p&gt;Table of contents&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#1-fundamental-terminologies&quot;&gt;1. Fundamental terminologies&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#11-what-is-postitive-negative-and-zero-sequence&quot;&gt;1.1. What is postitive, negative and zero sequence?&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#references&quot;&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;1-fundamental-terminologies&quot;&gt;1. Fundamental terminologies&lt;/h1&gt;

&lt;h2 id=&quot;11-what-is-postitive-negative-and-zero-sequence&quot;&gt;1.1. What is postitive, negative and zero sequence?&lt;/h2&gt;

&lt;p&gt;These components are so-called &lt;strong&gt;symmetrical components&lt;/strong&gt; &lt;sup id=&quot;fnref:ref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:ref1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;⚠️ Note:⚠️ The author was used $\underline{z}$ to denote a vector. However, I am using $\vec{z}$ to do this because of my personal preference.&lt;/p&gt;

&lt;p&gt;Symmetrical components allow unbalanced phase quantities such as currents and voltages to be replaced by three separate balanced symmetrical components&lt;/p&gt;

&lt;p&gt;The transformation is defined as:&lt;/p&gt;

\[\begin{bmatrix}
\vec{V}_+  \\
\vec{V}_-  \\
\vec{V}_0  \\
\end{bmatrix}

= \frac{1}{3}

\begin{bmatrix}
1 &amp;amp; \vec{a} &amp;amp; \vec{a}^2  \\
1 &amp;amp; \vec{a}^2 &amp;amp; \vec{a} \\
1 &amp;amp; 1 &amp;amp; 1 \\
\end{bmatrix}

\begin{bmatrix}
\vec{V}_a  \\
\vec{V}_b  \\
\vec{V}_c  \\
\end{bmatrix}

\qquad \text{ where } \vec{a} = e^{j 2 \pi /3}\]

&lt;p&gt;The invert transformation is:&lt;/p&gt;

\[\begin{bmatrix}
\vec{V}_a  \\
\vec{V}_b  \\
\vec{V}_c  \\
\end{bmatrix}

= 

\begin{bmatrix}
1 &amp;amp; 1 &amp;amp; 1  \\
\vec{a}^2 &amp;amp; \vec{a} &amp;amp; 1 \\
\vec{a} &amp;amp; \vec{a}^2 &amp;amp; 1 \\
\end{bmatrix}

\begin{bmatrix}
\vec{V}_+  \\
\vec{V}_-  \\
\vec{V}_0  \\
\end{bmatrix}\]

&lt;p&gt;Let take an example. Obtain the symmetrical components of a set of unbalanced voltage.&lt;/p&gt;

\[\vec{V_a} = 5 \angle 53 ^{\circ} \qquad \vec{V_b} = 7 \angle -164 ^{\circ} \qquad \vec{V_c} = 7 \angle 105 ^{\circ}\]

&lt;p&gt;Run this Matlab script to get the result.&lt;/p&gt;

&lt;div class=&quot;language-matlab highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;classdef&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lib&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;methods&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Static&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_out_theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_out_rho&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sym_components_theory&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isRadian&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;%% Symmetrical Components Theory&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% va: Unbalanced phase A voltage&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% vb: Unbalanced phase B voltage&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% vc: Unbalanced phase C voltage&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;%&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% v_out_theta_d: Output theta in degree (polar form)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% v_out_rho: Output radius (polar form)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% ┌─   ─┐       ┌─       ─┐ ┌─ ─┐&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% │V_0  │       │1 1   1  │ │V_a│&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% │V_pos│ = 1/3 │1 α   α^2│ │V_b│&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% │V_neg│       │1 α^2 α  │ │V_c│&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;% └─   ─┘       └─       ─┘ └─ ─┘&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;arguments&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;vc&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;isRadian&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;uint8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
         
            &lt;span class=&quot;n&quot;&gt;rho&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pi&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rho&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exp&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;a_tran&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alpha&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;v_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a_tran&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_out_theta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_out_rho&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cart2pol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;imag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isRadian&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;v_out_theta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v_out_theta&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-Matlab&quot;&gt;va = 5 * exp(1i*53/180*pi);
vb = 7 * exp(1i* (-164)/180*pi);
vc = 7 * exp (1i* 105/180 * pi);

% result is in Degree unit
[v_out_theta_d, v_out_rho] = lib.sym_components_theory  (va, vb, vc, 0)
v_sym = v_out_rho .* exp (1i * v_out_theta_d/180 * pi);
v_zero = v_sym(1);
v_pos = v_sym (2);
v_neg = v_sym (3);

%% Draw complex number

t = tiledlayout(2,2);
t.Padding = 'compact';
t.TileSpacing = 'compact';

% unbalanced voltage
z = [va, vb, vc];
nxt = nexttile;
c = compass(nxt, real(z), imag(z));
title(nxt,'Unbalanced voltage')

text(real(va) + 0.5, imag(va) + 0.5, 'Va', Color='b')

c_b = c(2);
c_b.Color = 'g'; % V_b is green
text(real(vb) - 1.5, imag(vb) + 0.5, 'Vb', Color='g')
c_c = c(3);
c_c.Color = 'r'; % V_c is red
text(real(vc) + 0.5, imag(vc) + 0.5, 'Vc', Color='r')

% positive voltage sequence
z_pos = [v_pos; v_pos * exp(1i * (-2) * pi / 3); v_pos * exp(1i * (-4) * pi / 3)];
nxt = nexttile;
c_pos = compass(nxt, real(z_pos), imag(z_pos));
title(nxt,'Positive voltage sequences')
c_pos_b = c_pos(2);
c_pos_b.Color = 'g'; % V_b is green
c_pos_c = c_pos(3);
c_pos_c.Color = 'r'; % V_c is red

%negative voltage sequency
z_neg = [v_neg; v_neg * exp(1i * (-4) * pi / 3); v_neg * exp(1i * (-2) * pi / 3)];
nxt = nexttile;
c_neg = compass(nxt, real(z_neg), imag(z_neg));
title(nxt,'Negative voltage sequences')
c_neg_b = c_neg(2);
c_neg_b.Color = 'g'; % V_b is green
c_neg_c = c_neg(3);
c_neg_c.Color = 'r'; % V_c is red

% Zero sequences
nxt = nexttile;
c_zero = compass(nxt, real(v_zero), imag(v_zero));
title(nxt,'Zero voltage sequences')

%% Unbalanced current
ia = 10;
ib = 10 * exp(1i* (-2)/3*pi);
ic = 0;
[i_out_theta_d, i_out_rho] = lib.sym_components_theory  (ia, ib, ic, 0)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/control-of-grid/symetrical-seq.svg&quot; alt=&quot;symetrical sequences&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We get $V_0, V_+, V_-$ phase and magnitude accordingly.&lt;/p&gt;

&lt;div class=&quot;language-matlab highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;v_out_theta_d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;

  &lt;span class=&quot;mf&quot;&gt;122.0788&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10.2643&lt;/span&gt;
   &lt;span class=&quot;mf&quot;&gt;92.4259&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;v_out_rho&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;

    &lt;span class=&quot;mf&quot;&gt;3.4718&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;5.0156&lt;/span&gt;
    &lt;span class=&quot;mf&quot;&gt;1.9469&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or, it could be written in the time domain form.&lt;/p&gt;

\[\begin{align*}
&amp;amp; v_a = 5.02 sin (\omega t - 10) + 1.95 sin (\omega t + 92) + 3.5 sin (\omega t + 122) \\
&amp;amp; v_b = 5.02 sin (\omega t - 10 - 120) + 1.95 sin (\omega t + 92 - 240) + 3.5 sin (\omega t + 122) \\
&amp;amp; v_c = \underbrace{5.02 sin (\omega t - 10 - 240)}_{\text{positive seq.}} + \underbrace{ 1.95 sin (\omega t + 92 - 120)}_{\text{negative seq.}} + \underbrace{3.5 sin (\omega t + 122)}_{\text{Zero seq.}} \\
\end{align*}\]

&lt;h1 id=&quot;references&quot;&gt;References&lt;/h1&gt;

&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:ref1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;James Kirtley Jr.. &lt;em&gt;6.061 Introduction to Electric Power Systems.&lt;/em&gt; Spring 2011. Massachusetts Institute of Technology: MIT OpenCourseWare, &lt;a href=&quot;https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-061-introduction-to-electric-power-systems-spring-2011/readings/MIT6_061S11_ch4.pdf&quot;&gt;https://ocw.mit.edu&lt;/a&gt; License: &lt;a href=&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;&gt;Creative Commons BY-NC-SA&lt;/a&gt;. &lt;a href=&quot;#fnref:ref1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pe" /><summary type="html">Table of contents 1. Fundamental terminologies 1.1. What is postitive, negative and zero sequence? References</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">MOSFET and IGBT</title><link href="https://circuitlover.com/mosfet-igbt/" rel="alternate" type="text/html" title="MOSFET and IGBT" /><published>2022-02-13T00:00:00+00:00</published><updated>2022-02-13T00:00:00+00:00</updated><id>https://circuitlover.com/MOSFET</id><content type="html" xml:base="https://circuitlover.com/mosfet-igbt/">&lt;p&gt;Table of contents&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#n-channel-mosfet&quot;&gt;N-channel MOSFET&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#physical-view&quot;&gt;Physical view&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#electrical-view&quot;&gt;Electrical view&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#circuit-symbol&quot;&gt;Circuit symbol&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#references&quot;&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;n-channel-mosfet&quot;&gt;N-channel MOSFET&lt;/h1&gt;

&lt;h2 id=&quot;physical-view&quot;&gt;Physical view&lt;/h2&gt;

&lt;p&gt;Current flows between diffusion terminals if the voltage on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Gate&lt;/code&gt; large enough to create a &lt;strong&gt;conducting channel&lt;/strong&gt;, otherwise the MOSFET is off and the diffusion terminals are not connected. &lt;sup id=&quot;fnref:ref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:ref1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/mosfet/nmosfet-physical-view.png&quot; alt=&quot;physical view&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;electrical-view&quot;&gt;Electrical view&lt;/h2&gt;

&lt;p&gt;The four terminals of a Field Effect Transitor are &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Gate&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Source&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Drain&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Bulk&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/mosfet/nmosfet-electrical-view.png&quot; alt=&quot;electrical view&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;circuit-symbol&quot;&gt;Circuit symbol&lt;/h2&gt;

&lt;p&gt;MOSFET and JFET circuit symbols&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;P-channel&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/JFET_P-Channel_Labelled.svg&quot; alt=&quot;s&quot; /&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/IGFET_P-Ch_Enh_Labelled.svg&quot; alt=&quot;d&quot; /&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/IGFET_P-Ch_Enh_Labelled_simplified.svg&quot; alt=&quot;d&quot; /&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/Mosfet_P-Ch_Sedra.svg&quot; alt=&quot;f&quot; /&gt;&lt;/th&gt;
      &lt;th&gt;&lt;img src=&quot;/images/posts/mosfet/IGFET_P-Ch_Dep_Labelled.svg&quot; alt=&quot;f&quot; /&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;N-channel&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/JFET_N-Channel_Labelled.svg&quot; alt=&quot;d&quot; /&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/IGFET_N-Ch_Enh_Labelled.svg&quot; alt=&quot;e&quot; /&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/IGFET_N-Ch_Enh_Labelled_simplified.svg&quot; alt=&quot;e&quot; /&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;img src=&quot;/images/posts/mosfet/Mosfet_N-Ch_Sedra.svg&quot; alt=&quot;r&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/images/posts/mosfet/IGFET_N-Ch_Dep_Labelled.svg&quot; alt=&quot;r&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;JFET (they are only in depletion mode)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;MOSFET enhancement mode&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;MOSFET enhancement mode (no bulk)&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;MOSFET enhancement mode (no bulk)&lt;/td&gt;
      &lt;td&gt;MOSFET depletion mode (switched on)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;tldr flex rounded-md bg-blue-300 bg-opacity-25 px-4 my-12&quot;&gt;
  &lt;div class=&quot;flex items-center&quot;&gt;
    &lt;div class=&quot;-ml-2 mr-2 my-6 transform rotate-90 tracking-tighter font-semibold text-blue-400&quot;&gt;TRICK&lt;/div&gt;
    &lt;p class=&quot;lg:text-lg leading-5 text-blue-800&quot;&gt;The arrow forms the pn junction from `buck` to `gate` in the symbol of MOSFET&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;When a channel exists in a MOSFET, current can flow from source to drain as well as from drain to source - it’s just a matter of how the device is connected in the circuit &lt;sup id=&quot;fnref:ref2&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:ref2&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. Conventional current flows from Drain to Source in an N Channel MOSFET.&lt;/p&gt;

&lt;h1 id=&quot;references&quot;&gt;References&lt;/h1&gt;
&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:ref1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Chris Terman. &lt;em&gt;6.004 Computation Structures.&lt;/em&gt; Spring 2017. Massachusetts Institute of Technology: MIT OpenCourseWare, &lt;a href=&quot;https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-004-computation-structures-spring-2017&quot;&gt;https://ocw.mit.edu&lt;/a&gt;. License: &lt;a href=&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;&gt;Creative Commons BY-NC-SA&lt;/a&gt;. &lt;a href=&quot;#fnref:ref1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:ref2&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;Adam Lawrence (https://electronics.stackexchange.com/users/1293/adam-lawrence), In an NMOS, does current flow from source to drain or vice-versa?, URL (version: 2012-11-11): https://electronics.stackexchange.com/q/48671 &lt;a href=&quot;#fnref:ref2&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pe" /><summary type="html">Table of contents N-channel MOSFET Physical view Electrical view Circuit symbol References</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Complex number and its application in AC analysist</title><link href="https://circuitlover.com/complex-number-application/" rel="alternate" type="text/html" title="Complex number and its application in AC analysist" /><published>2022-02-10T00:00:00+00:00</published><updated>2022-02-10T00:00:00+00:00</updated><id>https://circuitlover.com/sinusoidal-and-complex-number</id><content type="html" xml:base="https://circuitlover.com/complex-number-application/">&lt;p&gt;Table of contents&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#1-sinusoidal-time-functions-and-complex-number&quot;&gt;1. Sinusoidal time functions and complex number&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#11-complex-number-recap&quot;&gt;1.1. Complex number recap&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#12-sinusoidal-time-functions&quot;&gt;1.2. Sinusoidal Time Functions&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#13-summary&quot;&gt;1.3. Summary&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#2-impedance&quot;&gt;2. Impedance&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#example&quot;&gt;Example&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;1-sinusoidal-time-functions-and-complex-number&quot;&gt;1. Sinusoidal time functions and complex number&lt;/h2&gt;

&lt;h3 id=&quot;11-complex-number-recap&quot;&gt;1.1. Complex number recap&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/representation-of-the-complex-number.png&quot; alt=&quot;represenation of the complex number&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Magnitude and phase angle of the complex number $\vec{z}$ is &lt;sup id=&quot;fnref:ref1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:ref1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;⚠️ Note:⚠️ The author was used $\underline{z}$ to denote a vector. However, I am using $\vec{z}$ to do this because of my personal preference.&lt;/p&gt;

\[|\vec{z}|=\sqrt{x^{2}+y^{2}} \qquad 
\phi=\arctan \left(\frac{y}{x}\right)\]

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Euler&lt;/code&gt; relation&lt;/p&gt;

\[e^{j \phi}=\cos (\phi)+j \sin (\phi) \qquad 
\vec{z}=x+j y=|\vec{z}| e^{j \phi}\]

&lt;p&gt;The product and the ratio of two complex numbers are&lt;/p&gt;

\[\vec{z}_{1}=\left|\vec{z}_{1}\right| e^{j \phi_{1}} \qquad
\vec{z}_{2}=\left|\vec{z}_{2}\right| e^{j \phi_{2}}
\qquad
\vec{z}_{1} \vec{z}_{2}=\left|\vec{z}_{1}\right|\left|\vec{z}_{2}\right| e^{j\left(\phi_{1}+\phi_{2}\right)}
\qquad
\frac{\vec{z}_{1}}{\vec{z}_{2}}=\frac{\left|\vec{z}_{1}\right|}{\left|\vec{z}_{2}\right|} e^{j\left(\phi_{1}-\phi_{2}\right)}\]

&lt;p&gt;The complex conjugate of a complex number is given by&lt;/p&gt;

\[\vec{z}=x+j y
\quad
\vec{z}^{*}=x-j y
\qquad
\vec{z}+\vec{z}^{*}=2 \operatorname{Re}(\vec{z})=2 x
\qquad
\vec{z}-\vec{z}^{*}=2 j \operatorname{Im}(\vec{z})=2 j y\]

&lt;h3 id=&quot;12-sinusoidal-time-functions&quot;&gt;1.2. Sinusoidal Time Functions&lt;/h3&gt;

&lt;p&gt;A sinusoidal function of time might be written in three ways&lt;/p&gt;

\[f(t)=A \cos (\omega t+\phi) \qquad (1)\]

\[f(t)=B \cos (\omega t)+C \sin (\omega t) \qquad (2)\]

\[f(t)=\vec{X} e^{j \omega t}+\vec{X}^{*} e^{-j \omega t} \qquad (3)\]

&lt;p&gt;Equation &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(3)&lt;/code&gt; makes sure that that the resulting function is real. Now, let find out the relationship between equation &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1) and (3)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Let say&lt;/p&gt;

\[\vec{X}=|\vec{X}| e^{j \psi}\]

&lt;p&gt;then
\(f(t) =|\vec{X}| e^{j \psi} e^{j \omega t}+|\vec{X}|^{*} e^{-j \psi} e^{-j \omega t} =|\vec{X}| e^{j(\psi+\omega t)}+|\vec{X}|^{*} e^{-j(\psi+\omega t)}\)&lt;/p&gt;

\[f(t)=2|\vec{X}| \cos (\omega t+\psi)\]

&lt;p&gt;so we have&lt;/p&gt;

\[|\vec{X}| =\frac{A}{2} \qquad \psi =\phi\]

&lt;p&gt;Next, finding the relationship between equation &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(2) and (3)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Alternatively, we could write&lt;/p&gt;

\[\vec{X}=x+j y 
\qquad \text{where} \quad
x=|\vec{X}| \cos (\psi)
\qquad
y=|\vec{X}| \sin (\psi)\]

&lt;p&gt;thus&lt;/p&gt;

\[f(t)=\vec{X} e^{j \omega t}+\vec{X}^{*} e^{-j \omega t} = x\left(e^{j \omega t}+e^{-j \omega t}\right)+j y\left(e^{j \omega t}-e^{-j \omega t}\right)\]

\[f(t) =2 x \cos (\omega t)-2 y \sin (\omega t)\]

&lt;p&gt;Finally, we get&lt;/p&gt;

\[B = 2x \qquad C = -2y \qquad \vec{X} = \frac{B}{2} - j \frac{C}{2}\]

&lt;h3 id=&quot;13-summary&quot;&gt;1.3. Summary&lt;/h3&gt;

&lt;p&gt;Since 
\((\vec{X} e^{j \omega t})^{*} = \vec{X}^{*} e^{-j \omega t}\)&lt;/p&gt;

&lt;p&gt;expression &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(3) and (4)&lt;/code&gt; are equivalent. It is advantageous to use one or the other of them, according to circumstances.&lt;br /&gt;
It’s easy to notice that $\vec{X}$ is time-independent. This conclusion is used when forming the relationship between voltage and current of inductor and capacitor elements.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Sinusoidal form&lt;/th&gt;
      &lt;th&gt;Complex number form&lt;/th&gt;
      &lt;th&gt;$\vec{X}$&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;$f(t)=A \cos (\omega t+\phi)$&lt;/td&gt;
      &lt;td&gt;$f(t)=\vec{X} e^{j \omega t}+\vec{X}^{*} e^{-j \omega t} \quad (3)$&lt;/td&gt;
      &lt;td&gt;$\vec{X}={A}/{2} \angle \phi$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;$f(t)=B \cos (\omega t)+C \sin (\omega t)$&lt;/td&gt;
      &lt;td&gt;$f(t)=Re(2\vec{X} e^{j \omega t}) = Re(A e^{j \phi} e^{j \omega t})\quad (4)$&lt;/td&gt;
      &lt;td&gt;$\vec{X} = {B}/{2} - j {C}/{2}$&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;Strategy&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Transform the input &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;In&lt;/code&gt; into complex polar form $In \angle \phi$&lt;/li&gt;
  &lt;li&gt;Calculate impedance complex number $Z$&lt;/li&gt;
  &lt;li&gt;Transform output &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Out&lt;/code&gt; into polar form $O \angle \alpha$&lt;/li&gt;
  &lt;li&gt;Using expression &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(4)&lt;/code&gt; to find out $Out(t)$&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;2-impedance&quot;&gt;2. Impedance&lt;/h2&gt;
&lt;p&gt;Consider two elements, inductances and capacitances.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Inducatance    (L)&lt;/th&gt;
      &lt;th&gt;Capacitance (C)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/images/posts/Leading_lagging.jpg&quot; alt=&quot;inductor&quot; /&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/images/posts/Leading_lagging.jpg&quot; alt=&quot;capacitor&quot; /&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Current is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lagging&lt;/code&gt; voltage. (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;L&lt;/code&gt; means &lt;em&gt;Lower&lt;/em&gt; :arrow_lower_right:)&lt;/td&gt;
      &lt;td&gt;Current is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;leading&lt;/code&gt; voltage&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;$v_L = L {di}/{dt}$&lt;/td&gt;
      &lt;td&gt;$i = C \; {dV_C}/{dt}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;$v = \vec{V}e^{j \omega t} + \vec{V}^{*} e^{-j \omega t}$&lt;/td&gt;
      &lt;td&gt;$i = \vec{I}e^{j \omega t} + \vec{I}^{*} e^{-j \omega t}$&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;$\vec{V}=j \omega L \vec{I} = \vec{Z}_L \; \vec{I} \quad \text{where } \vec{Z}_L = j \omega L$&lt;/td&gt;
      &lt;td&gt;$\vec{I}=j \omega C \vec{V} = \vec{V} / \vec{Z}_C \quad \text{where } \vec{Z}_C = 1 / (j \omega C)$&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;The inverse of impedance is &lt;strong&gt;admittance&lt;/strong&gt;&lt;/p&gt;

\[\vec{Y} = 1/ \vec{Z}\]

&lt;h3 id=&quot;example&quot;&gt;Example&lt;/h3&gt;
&lt;p&gt;Suppose we are to find the voltage $v(t)$ in the network, in which $i(t) = I cos(\omega t)$
&lt;img src=&quot;/images/posts/complex-circuit-ex.png&quot; alt=&quot;complex number in circuit example&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Step 1.&lt;/code&gt; Transform the input &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;In&lt;/code&gt; into complex polar form $In \angle \phi$&lt;/p&gt;

\[i(t) = Re(I e^{\omega t})\]

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Step 2.&lt;/code&gt; Calculate impedance complex number 
\(Z _\| = \frac{R j \omega L}{R + j \omega L} = \frac{R \omega L}{\sqrt{R^2 + (\omega L)^2}} \angle (arctan \frac{R}{\omega L})\)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/complex-circuit-ex-phasor.jpg&quot; alt=&quot;phasor&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Step 3. &lt;/code&gt; We found the output voltage in the polar-exponential form&lt;/p&gt;

\[V = Z_\| I = \frac{IR \omega L}{\sqrt{R^2 + (\omega L)^2}} \angle (arctan \frac{R}{\omega L})\]

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Step 4.&lt;/code&gt; Using expression &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(4)&lt;/code&gt; to find out $v(t)$&lt;/p&gt;

\[v(t) = \frac{IR \omega L}{\sqrt{R^2 + (\omega L)^2}} cos ( \omega t + arctan \frac{R}{\omega L})\]

&lt;p&gt;&lt;strong&gt;References&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:ref1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;James Kirtley Jr.. &lt;em&gt;6.061 Introduction to Electric Power Systems.&lt;/em&gt; Spring 2011. Massachusetts Institute of Technology: MIT OpenCourseWare, &lt;a href=&quot;https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-061-introduction-to-electric-power-systems-spring-2011&quot;&gt;https://ocw.mit.edu&lt;/a&gt;. License: &lt;a href=&quot;https://creativecommons.org/licenses/by-nc-sa/4.0/&quot;&gt;Creative Commons BY-NC-SA&lt;/a&gt;. &lt;a href=&quot;#fnref:ref1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pe" /><summary type="html">Table of contents 1. Sinusoidal time functions and complex number 1.1. Complex number recap 1.2. Sinusoidal Time Functions 1.3. Summary 2. Impedance Example</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">The fundamental of DC-AC inverter</title><link href="https://circuitlover.com/dc-ac-inverter/" rel="alternate" type="text/html" title="The fundamental of DC-AC inverter" /><published>2022-01-06T00:00:00+00:00</published><updated>2022-01-06T00:00:00+00:00</updated><id>https://circuitlover.com/dc-ac-inverter</id><content type="html" xml:base="https://circuitlover.com/dc-ac-inverter/">&lt;p&gt;Table of contents&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#1-full-brige-inverters&quot;&gt;1. Full-brige inverters&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#11-biploar-pwm&quot;&gt;1.1. Biploar PWM&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#12-unipolar-pwm&quot;&gt;1.2. Unipolar PWM&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#13-hybrid-pwm&quot;&gt;1.3. Hybrid PWM&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vector-space-and-three-phase-inverter&quot;&gt;Vector space and three-phase inverter&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#power-losses-and-heating-design-of-an-dc-ac-inverter&quot;&gt;Power losses and heating design of an DC-AC inverter&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#references&quot;&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;1-full-brige-inverters&quot;&gt;1. Full-brige inverters&lt;/h1&gt;
&lt;p&gt;TL;DR&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Unipolar by definition: having or oriented in respect to a single pole.&lt;/li&gt;
  &lt;li&gt;Bipolar by definiton: having or involving the use of two poles or polarities.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;11-biploar-pwm&quot;&gt;1.1. Biploar PWM&lt;/h2&gt;

&lt;h2 id=&quot;12-unipolar-pwm&quot;&gt;1.2. Unipolar PWM&lt;/h2&gt;

&lt;h2 id=&quot;13-hybrid-pwm&quot;&gt;1.3. Hybrid PWM&lt;/h2&gt;

&lt;h1 id=&quot;vector-space-and-three-phase-inverter&quot;&gt;Vector space and three-phase inverter&lt;/h1&gt;

&lt;h1 id=&quot;power-losses-and-heating-design-of-an-dc-ac-inverter&quot;&gt;Power losses and heating design of an DC-AC inverter&lt;/h1&gt;
&lt;p&gt;Power losses of an inverter is defined as&lt;/p&gt;

\[P_{Loss} = P_{in} - P_{out}\]

&lt;p&gt;We could measure the losses in two ways.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Direct&lt;/strong&gt; measure $P_{in}$ and $P_{out}$. The stability of this method is difficult to achieve. A small variant in input or output could lead to a large error.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Indrect&lt;/strong&gt; by using Calorimetric methos. Highest accuracy is achieved, but it is complicate to operate.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;A alternative of measuring the losses is &lt;strong&gt;deriving the losses&lt;/strong&gt;. The losses can be calculated by estimate of 4 types of power losses.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Switching losses&lt;/li&gt;
  &lt;li&gt;Conducting Losses&lt;/li&gt;
  &lt;li&gt;Blocking losses (neglecgable)&lt;/li&gt;
  &lt;li&gt;Driving losses (neglecable)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The rule of thumb for a good design is 50% of switching losses and 50% of conducting losses. Let take a closer look at the three-phase inverter.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/dc-ac-inverter/three-phase-inverter.png&quot; alt=&quot;three phase inverter&quot; /&gt;&lt;/p&gt;

\[P_{conduction} = \frac{1}{2 \pi} \int_{0}^{2 \pi} v (\omega t) i (\omega t) dt\]

&lt;p&gt;Power switch is only conducting for half of period.&lt;/p&gt;

\[\begin{align*}

&amp;amp; P_C^{IGBT} = \frac{1}{2 \pi} \int_{0}^{\pi} \left[ V_{CE,0} \cdot i_{IGBT}(\omega t) + R_{CE} \cdot i_{IGBT}^2 (\omega t) \right] dt \\
  
&amp;amp; P_C^{MOSFET} = \frac{1}{2 \pi} \int_0^{\pi} \left [ r_{ds} \cdot i_{MOS}^2 (\omega t) \right ] dt \\

&amp;amp; P_C^{Diode} = \frac{1}{2 \pi} \int_0^{\pi} \left [ V_{Forward} \cdot i_{diode} (\omega t) + R_F \cdot i_{diode}^2 (\omega t) \right] dt

\end{align*}\]

\[\text{Note: } V_{CE,0}, \; R_{CE}, \; R_{DS}, \;V_{F,0}, \; R_{F} \text{ are from the datasheets of Mosfet/IGBT/Diode.}\]

&lt;p&gt;Using Kirchhoff’s current law, we have,&lt;/p&gt;

\[i_{IGBT} (\omega t) + i_{Diode} (\omega t) = \hat{i}_N \; sin(\omega t)\]

&lt;p&gt;where&lt;/p&gt;

\[\begin{align*}
  
&amp;amp; i_{IGBT}(\omega t) = m_{IGBT} (\omega t) \cdot \hat{i}_N \; sin(\omega t) \qquad (1) \\
&amp;amp; i_{Diode}(\omega t) = m_{Diode} (\omega t) \cdot \hat{i}_N \; sin (\omega t)

\end{align*}\]

&lt;p&gt;In case of Sine-triangle PWM modulation, modulation function $m = M \cdot sin(\omega t + \phi)$ with $M$ is modulation index.&lt;/p&gt;

\[\begin{align*}
  
&amp;amp; m_{IGBT} - m_{Diode} = m \qquad (2) \\
&amp;amp; m_{IGBT} + m_{Diode} = 1

\end{align*}\]

&lt;p&gt;we have,&lt;/p&gt;

\[\begin{align*}
  
&amp;amp;m_{IGBT} = \frac{1+m}{2} = \frac{1}{2} \left( 1 + M \cdot sin(\omega t) \right) \qquad (3) \\

&amp;amp;m_{Diode} = \frac{1-m}{2} = \frac{1}{2} \left( 1 - M \cdot sin(\omega t) \right) 

\end{align*}\]

&lt;p&gt;Replace equation &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(1)&lt;/code&gt; by equation &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(3)&lt;/code&gt; we get,&lt;/p&gt;

\[i_{IGBT} (\omega t) = \frac{1}{2}  \left[ 1 + M \cdot sin(\omega t) \right]  \hat{i}_N \; sin(\omega t) \\
i_{Diode} (\omega t) = \frac{1}{2}  \left[ 1 - M \cdot sin(\omega t) \right]  \hat{i}_N \; sin(\omega t)\]

&lt;p&gt;Finally, we get the important formular for conduction losses.&lt;/p&gt;

\[\begin{align*}
  
&amp;amp; P^{IGBT}_C = \frac{\hat{i_N} \cdot V_{CE,0}}{2 \pi} \left( 1 + \frac{M \cdot \pi}{4} cos \phi \right) + \frac{R_{CE} \cdot \hat{i_N}^2}{2 \pi} (\frac{\pi}{4} + \frac{2M}{3} cos\phi) \\

&amp;amp; P^{MOS}_C = \frac{R_{DS} \cdot \hat{i_N}^2}{2 \pi} (\frac{\pi}{4} + \frac{2M}{3} cos\phi) \qquad (V_{CE,0} = 0) \\

&amp;amp; P^{Diode}_C = \frac{\hat{i_N} \cdot V_{F,0}}{2 \pi} \left( 1 - \frac{M \cdot \pi}{4} cos \phi \right) + \frac{R_{F} \cdot \hat{i_N}^2}{2 \pi} (\frac{\pi}{4} - \frac{2M}{3} cos\phi)

\end{align*}\]

&lt;p&gt;Since $R_{DS} \gg R_{CE}$, we could say that $P_C^{MOS}$ is not smaller than $P_C^{IBGT}$.&lt;/p&gt;

&lt;h1 id=&quot;references&quot;&gt;References&lt;/h1&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pe" /><summary type="html">Table of contents 1. Full-brige inverters 1.1. Biploar PWM 1.2. Unipolar PWM 1.3. Hybrid PWM Vector space and three-phase inverter Power losses and heating design of an DC-AC inverter References</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Connect Raspberry Pi Zero (not W) to the Internet</title><link href="https://circuitlover.com/connect-Pi-Zero-to-internet/" rel="alternate" type="text/html" title="Connect Raspberry Pi Zero (not W) to the Internet" /><published>2020-12-11T00:00:00+00:00</published><updated>2020-12-11T00:00:00+00:00</updated><id>https://circuitlover.com/connect-Pi-Zero-to-internet</id><content type="html" xml:base="https://circuitlover.com/connect-Pi-Zero-to-internet/">&lt;p&gt;Raspi Zero (not W) have neither Wi-Fi nor Ethernet, so how could we want to update your raspbian without remove the microSD card? 
Well, you can create a virtual Ethernet interface. This method is tested on &lt;strong&gt;Window 10&lt;/strong&gt;, you could get the same idea when using Linux/Mac computer.&lt;/p&gt;

&lt;p&gt;I am testing &lt;a href=&quot;https://downloads.raspberrypi.org/raspios_lite_armhf/images/raspios_lite_armhf-2022-01-28/2022-01-28-raspios-bullseye-armhf-lite.zip&quot;&gt;2022-01-28-raspios-bullseye-armhf-lite image&lt;/a&gt; version.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pi@raspberrypi:~ &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt;
Linux raspberrypi 5.10.92+ &lt;span class=&quot;c&quot;&gt;#1514 Mon Jan 17 17:35:21 GMT 2022 armv6l GNU/Linux&lt;/span&gt;
pi@raspberrypi:~ &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /proc/device-tree/model
Raspberry Pi Zero Rev 1.3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Table of contents&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#1-update-cmdlinetxt-and-configtxt-settings&quot;&gt;1. Update cmdline.txt and config.txt settings&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#2-script-to-create-a-virtual-udc-ethernet-interface&quot;&gt;2. Script to create a virtual UDC ethernet interface&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#3-window-settings-for-internet-connection-sharing&quot;&gt;3. Window settings for Internet Connection Sharing&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#4-references&quot;&gt;4. References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The network topology I’m going to deploy it as follows.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/pi/Pi-Zero-internet.png&quot; alt=&quot;Pi Zero Internet&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;1-update-cmdlinetxt-and-configtxt-settings&quot;&gt;1. Update cmdline.txt and config.txt settings&lt;/h3&gt;

&lt;p&gt;This method is using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libcomposite&lt;/code&gt;, so you need to include &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libcomposite&lt;/code&gt; in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;modules-load&lt;/code&gt; directive as the following. For other methods, please visit &lt;a href=&quot;https://gist.github.com/gbaman&quot;&gt;gbaman&lt;/a&gt;/&lt;a href=&quot;https://gist.github.com/gbaman/50b6cca61dd1c3f88f41&quot;&gt;HowToOTG.md&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@raspberrypi:/home/pi# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /boot/cmdline.txt
&lt;span class=&quot;nv&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;serial0,115200 &lt;span class=&quot;nv&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;tty1 &lt;span class=&quot;nv&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PARTUUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;22e47bc0-02 &lt;span class=&quot;nv&quot;&gt;rootfstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ext4 fsck.repair&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;yes &lt;/span&gt;rootwait modules-load&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dwc2,libcomposite
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dtoverlay=dwc2&lt;/code&gt; at the end of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/boot/config.txt&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@raspberrypi:/home/pi# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /boot/config.txt
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Omitted&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;cm4]
&lt;span class=&quot;c&quot;&gt;# Enable host mode on the 2711 built-in XHCI USB controller.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This line should be removed if the legacy DWC2 controller is required&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (e.g. for USB device mode) or if USB support is not required.&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;otg_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;all]

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;pi4]
&lt;span class=&quot;c&quot;&gt;# Run as fast as firmware / board allows&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;arm_boost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;all]
&lt;span class=&quot;c&quot;&gt;# Enable UART&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;enable_uart&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1
&lt;span class=&quot;nv&quot;&gt;dtoverlay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dwc2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-script-to-create-a-virtual-udc-ethernet-interface&quot;&gt;2. Script to create a virtual UDC ethernet interface&lt;/h3&gt;

&lt;p&gt;The script below will create a virtual UDC ethernet interface.&lt;/p&gt;

&lt;div role=&quot;alert&quot;&gt;
  &lt;div class=&quot;bg-red-500 text-white font-bold rounded-t px-4 py-2&quot;&gt;
    Note
  &lt;/div&gt;
  &lt;div class=&quot;border border-t-0 border-red-400 rounded-b bg-red-100 px-4 py-3 text-red-700&quot;&gt;
    &lt;p&gt;In order to make Pi Zero to become plug-and-play as much as possible, I am faking IBM Corporation RNDIS Driver on Window because of lacking the Linux Driver on the Window 7. If you are using MacOS/Linux, you should change OS_CONFIG to macos/linux accordingly.&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Thanks to&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   wismna: http://github.com/wismna/raspberry-pi/hackpi&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#   RoganDawes: https://github.com/RoganDawes/P4wnP1&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# https://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/enumeration-of-the-composite-parent-device&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# https://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/usb-common-class-generic-parent-driver&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;OS_CONFIG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;window&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;IP_SELF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.137.2&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;IP_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.137.1&quot;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;MAC_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;48:6f:73:74:50:43&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# &quot;Mac address for host PC&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;MAC_SELF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;42:61:64:55:53:42&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# &quot;MAC address for PiZero&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;CONFIG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/sys/kernel/config/usb_gadget/PiZero

&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CONFIG&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CONFIG&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1


&lt;span class=&quot;c&quot;&gt;# 0x04b3 = 1203&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# {&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#     &quot;name&quot;: &quot;IBM Corporation&quot;,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#     &quot;field_vid&quot;: &quot;1203&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# },&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OS_CONFIG&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in
  &lt;/span&gt;window&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# wismna hack for Window&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# IBM Corporation RNDIS Driver will be loaded&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x04b3 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; idVendor
    &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x4010 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; idProduct
    &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x1d6b &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; idVendor   &lt;span class=&quot;c&quot;&gt;# Linux Foundation&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x0104 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; idProduct  &lt;span class=&quot;c&quot;&gt;# Multifunction Composite Gadget&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x0100 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; bcdDevice
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x0200 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; bcdUSB

&lt;span class=&quot;c&quot;&gt;# Mandatory for Multiple Gadgets&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0xEF &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; bDeviceClass
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x02 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; bDeviceSubClass
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x01 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; bDeviceProtocol
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0x40 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; bMaxPacketSize0

&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; strings/0x409
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; configs/c.1/strings/0x409
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;100000000d2386db         &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; strings/0x409/serialnumber
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;PiZero Project&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; strings/0x409/manufacturer
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;PiZero &quot;&lt;/span&gt;              &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; strings/0x409/product
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;250                      &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; configs/c.1/MaxPower
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;PiZero&quot;&lt;/span&gt;               &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; configs/c.1/strings/0x409/configuration

config_acm&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; functions/acm.usb0
  &lt;span class=&quot;nb&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; functions/acm.usb0 configs/c.1/acm.usb0
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Ethernet Adapter&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#-------------------------------------------&lt;/span&gt;
config_rndis &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; functions/rndis.usb0
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$MAC_HOST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; functions/rndis.usb0/host_addr
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$MAC_SELF&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; functions/rndis.usb0/dev_addr

  &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; os_desc
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0x80&quot;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; configs/c.1/bmAttributes
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;1&quot;&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; os_desc/use
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0xbc&quot;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; os_desc/b_vendor_code
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;MSFT100&quot;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; os_desc/qw_sign

  &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; functions/rndis.usb0/os_desc/interface.rndis
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;RNDIS&quot;&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; functions/rndis.usb0/os_desc/interface.rndis/compatible_id
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;5162001&quot;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; functions/rndis.usb0/os_desc/interface.rndis/sub_compatible_id

  &lt;span class=&quot;nb&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; functions/rndis.usb0 configs/c.1/
  &lt;span class=&quot;nb&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; configs/c.1/ os_desc
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

config_ecm &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; functions/ecm.usb0
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$MAC_HOST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; functions/ecm.usb0/host_addr
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$MAC_SELF&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; functions/ecm.usb0/dev_addr
  &lt;span class=&quot;nb&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; functions/ecm.usb0 configs/c.1/
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OS_CONFIG&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in
  &lt;/span&gt;window&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    config_rndis
    &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  macos &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; linux&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    config_ecm
    &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    config_acm
    &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;

udevadm settle &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 5 &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; :
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /sys/class/udc &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; UDC
ifconfig usb0 &lt;span class=&quot;nv&quot;&gt;$IP_SELF&lt;/span&gt; netmask 255.255.255.252 up
route add &lt;span class=&quot;nt&quot;&gt;-net&lt;/span&gt; default gw &lt;span class=&quot;nv&quot;&gt;$IP_HOST&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p class=&quot;text rounded-lg bg-blue-200 bg-opacity-25 text-blue-700 px-8 py-4 my-4&quot;&gt;
  I am using 192.168.137.2 address because when I enable Internet Connection Sharing (ICS) on my Wi-Fi adapter, the second NIC get shared Internet will get 192.168.137.1 as you can see in the following steps. You should change the IP address accordingly to your situation.
&lt;/p&gt;

&lt;p&gt;Save the file as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;runme.sh&lt;/code&gt;, and don’t forget to change its permission to executable file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@raspberrypi:/home/pi# &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x runme.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In order to get the script run at boot up, one simple way is adding this script into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rc.local&lt;/code&gt;. See more ways to do this at &lt;a href=&quot;https://learn.sparkfun.com/tutorials/how-to-run-a-raspberry-pi-program-on-startup/all&quot;&gt;How to Run a Raspberry Pi Program on Startup&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@raspberrypi:/home/pi# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/rc.local
&lt;span class=&quot;c&quot;&gt;#!/bin/sh -e&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Omitted&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Print the IP address&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;_IP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hostname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-I&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_IP&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;My IP address is %s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_IP&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

/home/pi/runme.sh &amp;amp;

&lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want to ssh to your PiZero, you could enable SSHD for later use.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;ssh
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl start ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is time to reboot your PI to apply these settings.&lt;/p&gt;

&lt;h3 id=&quot;3-window-settings-for-internet-connection-sharing&quot;&gt;3. Window settings for Internet Connection Sharing&lt;/h3&gt;

&lt;p&gt;Go to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Control Panel\Network and Internet\Network Connections&lt;/code&gt;. If everything is good, you should see a new Ethernet Adapter (i.e., Ethernet 4 in my case).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/pi/window-setting-new-NIC.png&quot; alt=&quot;Window IP setting&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now, you need to share the Internet from your main NIC to the new created NIC by PiZero.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/pi/window-setting-sharing.png&quot; alt=&quot;Window network sharing&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Right click on NIC icon choose &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Properties&lt;/code&gt;, go to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Properties&lt;/code&gt; one more and then &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Sharing&lt;/code&gt; tab.&lt;/li&gt;
  &lt;li&gt;Check the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Allow Other Network Users ... &lt;/code&gt; check box.&lt;/li&gt;
  &lt;li&gt;Under &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Home networking connection&lt;/code&gt;, choose the new NIC (i.e., &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ethernet 4&lt;/code&gt; in my case)&lt;/li&gt;
  &lt;li&gt;Click &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;OK&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;You will see a pop-up states that &lt;strong&gt;Ethernet 4&lt;/strong&gt; IP address will be changed to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;19.268.137.1&lt;/code&gt;. That is why I used this IP address in the above &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;runme.sh&lt;/code&gt; script.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/posts/pi/window-setting-IP-forwarding.png&quot; alt=&quot;Window setting IP&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Try to connect from your PC to your Pi Zero. I am using SSH to connect because I already enabled SSHD service on PiZero.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt;ssh pi@192.168.137.2
The authenticity of host &lt;span class=&quot;s1&quot;&gt;'192.168.137.2 (192.168.137.2)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is SHA256:LxSEz/DS/6u6EQQWI+rr.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '&lt;/span&gt;192.168.137.2&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
pi@192.168.137.2'&lt;/span&gt;s password:
Linux raspberrypi 5.10.92+ &lt;span class=&quot;c&quot;&gt;#1514 Mon Jan 17 17:35:21 GMT 2022 armv6l&lt;/span&gt;

pi@raspberrypi:~ &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
pi@raspberrypi:~ &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ping google.com
PING google.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;216.58.207.206&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 56&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;84&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; bytes of data.
64 bytes from arn11s04-in-f14.1e100.net &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;216.58.207.206&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;58 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;16.7 ms
64 bytes from arn11s04-in-f14.1e100.net &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;216.58.207.206&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: &lt;span class=&quot;nv&quot;&gt;icmp_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 &lt;span class=&quot;nv&quot;&gt;ttl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;58 &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;16.4 ms
^C
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; google.com ping statistics &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
2 packets transmitted, 2 received, 0% packet loss, &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;1002ms
rtt min/avg/max/mdev &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 16.397/16.525/16.654/0.128 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In case you have problem with the DNS, try to change the DNS server on PiZero by editing &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/resolv.conf&lt;/code&gt; file.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pi@raspberrypi:~ &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/resolv.conf
&lt;span class=&quot;c&quot;&gt;# Generated by resolvconf&lt;/span&gt;
nameserver 8.8.8.8 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div role=&quot;alert&quot;&gt;
  &lt;div class=&quot;bg-red-500 text-white font-bold rounded-t px-4 py-2&quot;&gt;
    Important note
  &lt;/div&gt;
  &lt;div class=&quot;border border-t-0 border-red-400 rounded-b bg-red-100 px-4 py-3 text-red-700&quot;&gt;
    &lt;p&gt;If it doesn't work, disable antivirus program in your computer and try again. You may also need to disable and enable &lt;strong&gt;network sharing &lt;/strong&gt; in your Window computer.&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;Done! Now you could use the Internet on your Pi Zero.&lt;/p&gt;

&lt;h3 id=&quot;4-references&quot;&gt;4. References&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/showmewebcam/showmewebcam/pull/76/files&quot;&gt;showmewebcam #76&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://learn.sparkfun.com/tutorials/how-to-run-a-raspberry-pi-program-on-startup/all&quot;&gt;How to Run a Raspberry Pi Program on Startup&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gist.github.com/gbaman&quot;&gt;gbaman&lt;/a&gt;/&lt;a href=&quot;https://gist.github.com/gbaman/50b6cca61dd1c3f88f41&quot;&gt;HowToOTG.md&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="pi" /><summary type="html">Raspi Zero (not W) have neither Wi-Fi nor Ethernet, so how could we want to update your raspbian without remove the microSD card? Well, you can create a virtual Ethernet interface. This method is tested on Window 10, you could get the same idea when using Linux/Mac computer.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/posts/pi/Pi-Zero-internet.png" /><media:content medium="image" url="https://circuitlover.com/images/posts/pi/Pi-Zero-internet.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">How to upgrade flash chip on TPLink TL-WR840N v5.</title><link href="https://circuitlover.com/upgrade-flash-chip-tplink-tl-wr840n-4mb-to-8mb/" rel="alternate" type="text/html" title="How to upgrade flash chip on TPLink TL-WR840N v5." /><published>2019-02-11T00:00:00+00:00</published><updated>2019-02-11T00:00:00+00:00</updated><id>https://circuitlover.com/upgrade-flash-chip-tplink-tl-wr840n-4mb-to-8mb</id><content type="html" xml:base="https://circuitlover.com/upgrade-flash-chip-tplink-tl-wr840n-4mb-to-8mb/">&lt;p&gt;Upgrade TP-Link flash chip on TP-Link from 4mb to 8mb&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Table of content&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#1-pre-requirement&quot;&gt;1. Pre-requirement&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#2-lets-do-it&quot;&gt;2. Let’s do it&lt;/a&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#21-desolder-old-flash-chip&quot;&gt;2.1 Desolder old flash chip&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#22-program-new-flash-chip&quot;&gt;2.2 Program new flash chip&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#23-re-solder-new-flash-chip&quot;&gt;2.3 Re-solder new flash chip&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#3-enjoy&quot;&gt;3. Enjoy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;1-pre-requirement&quot;&gt;1. Pre-requirement&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;New flash chip: I used Winbond 8MiB GD25Q64CSIG&lt;/li&gt;
  &lt;li&gt;Soldering iron: desolder old flash chip and re-solder new flash chip&lt;/li&gt;
  &lt;li&gt;ROM programer and IC socket: I am using CH-341A (~ 5$)&lt;/li&gt;
  &lt;li&gt;One PC/Laptop&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2-lets-do-it&quot;&gt;2. Let’s do it&lt;/h2&gt;
&lt;h3 id=&quot;21-desolder-old-flash-chip&quot;&gt;2.1 Desolder old flash chip&lt;/h3&gt;
&lt;p&gt;Hot air soldering station is ideally suited for desoldering flash. If you not, you can follow this video to do this.&lt;/p&gt;

&lt;div class=&quot;embed-responsive aspect-w-16 aspect-h-9&quot;&gt;
  &lt;iframe class=&quot;embed-responsive-item&quot; src=&quot;https://www.youtube.com/embed/nZGEtpECPQY&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;h3 id=&quot;22-program-new-flash-chip&quot;&gt;2.2 Program new flash chip&lt;/h3&gt;
&lt;p&gt;Firstly, you need to choose new flash chip you want to replace. Why I chose &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Winbond GD25Q64CSIG&lt;/code&gt; for replacement, see table bellow:&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/tuyenld/acb0f0e62cadca73b7dffc44d7cc1b4b.js?file=Original_vs_Mod_Chip.md&quot;&gt;&lt;/script&gt;

&lt;p&gt;I see the name of flash chip is the same, so I didn’t checked datasheet for compatible.&lt;/p&gt;

&lt;p&gt;Secondly, you need to choose OpenWRT firmware.
Why I used openwrt-18.06.1-ramips-mt76x8-tl-&lt;strong&gt;wr841n-v13&lt;/strong&gt;-squashfs-sysupgrade instead of openwrt-18.06.1-ramips-mt76x8-tl-&lt;strong&gt;wr840n-v5&lt;/strong&gt;-squashfs-sysupgrade?&lt;/p&gt;

&lt;p&gt;Because it used the same CPU and different in flash and RAM chip.
&lt;script src=&quot;https://gist.github.com/tuyenld/acb0f0e62cadca73b7dffc44d7cc1b4b.js?file=WR841Nv13_vs_WR840Nv5.md&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;div class=&quot;tldr flex rounded-md bg-blue-300 bg-opacity-25 px-4 my-12&quot;&gt;
  &lt;div class=&quot;flex items-center&quot;&gt;
    &lt;div class=&quot;-ml-2 mr-2 my-6 transform rotate-90 tracking-tighter font-semibold text-blue-400&quot;&gt;NOTE&lt;/div&gt;
    &lt;p class=&quot;lg:text-lg leading-5 text-blue-800&quot;&gt;You are able to use openwrt-18.06.1-ramips-mt76x8-tl-**wr840n-v5**-squashfs-sysupgrade with 8MB flash chip, your router still booting but you can not any configuration after reboot. You may got error `Your image is probably too big, leaving not enough space for jffs2`.&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;p&gt;In the first time, I faced this problem. I can not save any configuration after reboot. If you look at boot log, it read:
&lt;script src=&quot;https://gist.github.com/tuyenld/acb0f0e62cadca73b7dffc44d7cc1b4b.js?file=firmware_bad.log&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;No &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/overlay&lt;/code&gt; will be mounted:
&lt;script src=&quot;https://gist.github.com/tuyenld/acb0f0e62cadca73b7dffc44d7cc1b4b.js?file=firmware_bad_no_overlay.log&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;If everything is good, it should be like this:
&lt;script src=&quot;https://gist.github.com/tuyenld/acb0f0e62cadca73b7dffc44d7cc1b4b.js?file=firmware_good.log&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;p&gt;Now, you have new flash chip and suitable firware, but you can not use this firware to program new flash chip. Because &lt;strong&gt;RAW&lt;/strong&gt; flash need more partion than firmware such as: bootloader and art. See more in &lt;a href=&quot;https://openwrt.org/docs/techref/flash.layout&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can use bellow shell script to generate firmware for any flash with different capacity.
&lt;script src=&quot;https://gist.github.com/tuyenld/acb0f0e62cadca73b7dffc44d7cc1b4b.js?file=create_new_firmware.sh&quot;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/tuyenld/acb0f0e62cadca73b7dffc44d7cc1b4b.js?file=flash_partition.md&quot;&gt;&lt;/script&gt;

&lt;p&gt;If you don’t want to use this script, you can create image by yourself. You may to need hex editor like &lt;a href=&quot;https://mh-nexus.de/en/hxd/&quot;&gt;HxDen&lt;/a&gt; to do this.&lt;/p&gt;
&lt;figure class=&quot;align-center&quot;&gt;
  &lt;img src=&quot;https://res.cloudinary.com/crushcoding/image/upload/q_auto,f_auto/2019-02-11-upgrade-flash-chip-tplink-tl-wr840n-4mb-to-8mb/create_image_manual.jpg&quot; alt=&quot;&quot; /&gt;
  &lt;figcaption&gt;New firmware layout&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;All file which I used in &lt;a href=&quot;https://drive.google.com/file/d/1kqXvFQYrolipvrrD3Rkv7J7JTZwgVHDn/view?usp=sharing&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;23-re-solder-new-flash-chip&quot;&gt;2.3 Re-solder new flash chip&lt;/h3&gt;
&lt;p&gt;After use CH341A to program new flash chip, you can re-solder new flash chip on target board.&lt;/p&gt;

&lt;div class=&quot;tldr flex rounded-md bg-blue-300 bg-opacity-25 px-4 my-12&quot;&gt;
  &lt;div class=&quot;flex items-center&quot;&gt;
    &lt;div class=&quot;-ml-2 mr-2 my-6 transform rotate-90 tracking-tighter font-semibold text-blue-400&quot;&gt;NOTE&lt;/div&gt;
    &lt;p class=&quot;lg:text-lg leading-5 text-blue-800&quot;&gt;If your board can not booting, don't worry. You can use [Clip Socket Adapter](https://www.ebay.com/itm/SOIC8-SOP8-Flash-Chip-IC-Test-Clip-Socket-Adapter-BIOS-CH341A-USB-Programmer-/372555847443) to try program flash again with out desolder chip.&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&quot;3-enjoy&quot;&gt;3. Enjoy&lt;/h2&gt;
&lt;figure class=&quot;align-center&quot;&gt;
  &lt;img src=&quot;https://res.cloudinary.com/crushcoding/image/upload/q_auto,f_auto/2019-02-11-upgrade-flash-chip-tplink-tl-wr840n-4mb-to-8mb/software_status.jpg&quot; alt=&quot;&quot; /&gt;
  &lt;figcaption&gt;Software with new flash chip (8MB).&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;div class=&quot;tldr flex rounded-md bg-blue-300 bg-opacity-25 px-4 my-12&quot;&gt;
  &lt;div class=&quot;flex items-center&quot;&gt;
    &lt;div class=&quot;-ml-2 mr-2 my-6 transform rotate-90 tracking-tighter font-semibold text-blue-400&quot;&gt;NOTE&lt;/div&gt;
    &lt;p class=&quot;lg:text-lg leading-5 text-blue-800&quot;&gt;I used image come from **TL-WR841N v13.x**, except for LED will not working, everything work well (Wi-Fi, Ethernet, Router feature).&lt;/p&gt;
  &lt;/div&gt;
&lt;/div&gt;</content><author><name>Dinh-Tuyen Le</name><email>tuyenld@circuitlover.com</email></author><category term="uncategorized" /><category term="TL-WR840N" /><summary type="html">Upgrade TP-Link flash chip on TP-Link from 4mb to 8mb</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://circuitlover.com/images/author.png" /><media:content medium="image" url="https://circuitlover.com/images/author.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>